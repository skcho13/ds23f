<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sungkyun Cho">
<meta name="dcterms.date" content="2024-10-31">

<title>Transforming I –  Data Analysis &amp; Visualization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../contents/Transform/case1.html" rel="next">
<link href="../../contents/Transform/subsetting.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5R1D200E6D"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5R1D200E6D', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<meta property="og:title" content="Transforming I –  Data Analysis &amp; Visualization">
<meta property="og:description" content="R for Data Science by Wickham &amp; Grolemund">
<meta property="og:site_name" content="Data Analysis and Visualization in Python">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Transforming I</h1>
        </a>     
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../"><i class="fa-solid fa-chart-simple" aria-label="chart-simple"></i> Data Analysis &amp; Visualization</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"> Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/notice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"> Notice</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Introduction/intro2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Analysis Intro</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Introduction/rethinking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Thinking</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Introduction/setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../contents/Introduction/pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NumPy and pandas</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Introduction/inspection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inspecting data</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Introduction/vis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data visualization</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Visualize</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Visualize/seaborn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Seaborn.objects</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../contents/Visualize/plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plots</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Visualize/alt_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Alternative plots</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Visualize/customizing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Customizing</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../contents/EDA/eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory Data Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/EDA/discretize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discretize</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Transform</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Transform/subsetting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Subsetting</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../contents/Transform/transform.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Transforming I</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Transform/case1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Transform/babynames.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Case 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Transform/exercise_transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Transforming II</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Transform/combine.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Combine</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Transform/pivot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pivot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Transform/crosstab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pivot Table</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Transform/exercise_wrangle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Transform/misc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Misc.</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Exercises/billboard.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Billboard</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Exercises/movielens.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MovieLens</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Solutions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Transform/sol1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transforming I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Transform/sol2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transforming II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Exercises/billboard_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Billboard</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Exercises/movielens_sol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MovieLens</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">Modelling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Modelling/model-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Modelling/modelling1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Building I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Modelling/modelling2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model building II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Modelling/modelling1_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modelling 1 Ex.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/Modelling/modelling2_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modelling 2 Ex.</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true">
 <span class="menu-text">Communicate</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://docs.google.com/document/d/1g57REsUnvtSa1Yxr9WWP63yQivs4DO_0wVDHS9A3bO4/edit?usp=sharing" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ask</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#rows" id="toc-rows" class="nav-link active" data-scroll-target="#rows">Rows</a>
  <ul>
  <li><a href="#query" id="toc-query" class="nav-link" data-scroll-target="#query"><code>query()</code></a></li>
  <li><a href="#sort_values" id="toc-sort_values" class="nav-link" data-scroll-target="#sort_values"><code>sort_values()</code></a></li>
  <li><a href="#unique" id="toc-unique" class="nav-link" data-scroll-target="#unique"><code>unique()</code></a></li>
  </ul></li>
  <li><a href="#columns" id="toc-columns" class="nav-link" data-scroll-target="#columns">Columns</a>
  <ul>
  <li><a href="#select" id="toc-select" class="nav-link" data-scroll-target="#select">Select</a></li>
  <li><a href="#rename" id="toc-rename" class="nav-link" data-scroll-target="#rename"><code>rename()</code></a></li>
  <li><a href="#assign" id="toc-assign" class="nav-link" data-scroll-target="#assign"><code>assign()</code></a></li>
  </ul></li>
  <li><a href="#groups" id="toc-groups" class="nav-link" data-scroll-target="#groups">Groups</a>
  <ul>
  <li><a href="#groupby" id="toc-groupby" class="nav-link" data-scroll-target="#groupby"><code>groupby()</code></a></li>
  <li><a href="#agg" id="toc-agg" class="nav-link" data-scroll-target="#agg"><code>agg()</code></a></li>
  <li><a href="#transform" id="toc-transform" class="nav-link" data-scroll-target="#transform"><code>transform()</code></a></li>
  <li><a href="#apply" id="toc-apply" class="nav-link" data-scroll-target="#apply"><code>apply()</code></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Transforming I</h1>
<p class="subtitle lead">R for Data Science by Wickham &amp; Grolemund</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sungkyun Cho </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 31, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div id="cell-1" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Load packages</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># numerical calculation &amp; data frames</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># visualization</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn.objects <span class="im">as</span> so</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># statistics</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># pandas options</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'mode.copy_on_write'</span>, <span class="va">True</span>)  <span class="co"># pandas 2.0</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>pd.options.display.float_format <span class="op">=</span> <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>  <span class="co"># pd.reset_option('display.float_format')</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>pd.options.display.max_rows <span class="op">=</span> <span class="dv">7</span>  <span class="co"># max number of rows to display</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># NumPy options</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>np.set_printoptions(precision <span class="op">=</span> <span class="dv">2</span>, suppress<span class="op">=</span><span class="va">True</span>)  <span class="co"># suppress scientific notation</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># For high resolution display</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib_inline</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>matplotlib_inline.backend_inline.set_matplotlib_formats(<span class="st">"retina"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>이번 장에서는 시각화를 하기 전후로, 중요한 데이터 패턴을 보기 위해서 새로운 변수를 만들거나 요약한 통계치를 만들 필요가 있는데 이를 다루는 핵심적인 함수들에 대해 익힙니다.</p>
<p>대략 다음과 같은 transform들을 조합하여 분석에 필요한 상태로 바꿉니다.</p>
<ul>
<li>변수들의 선택: <code>subsetting</code></li>
<li>조건에 맞는 부분(관측치, 행)만 필터링: <code>query()</code></li>
<li>조건에 맞도록 행을 재정렬: <code>sort_values()</code></li>
<li>변수들과 함수들을 이용하여 새로운 변수를 생성: <code>assign()</code></li>
<li>카테고리별로 나뉘어진 데이터에 대한 통계치를 생성: <code>groupby()</code>, <code>agg()</code>, <code>apply()</code></li>
</ul>
<hr>
<p><em>On-time data for all flights that departed NYC (i.e.&nbsp;JFK, LGA or EWR) in 2013</em></p>
<div id="cell-5" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import the dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>flights_data <span class="op">=</span> sm.datasets.get_rdataset(<span class="st">"flights"</span>, <span class="st">"nycflights13"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>flights <span class="op">=</span> flights_data.data</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>flights <span class="op">=</span> flights.drop(columns<span class="op">=</span><span class="st">"time_hour"</span>)  <span class="co"># drop the "time_hour" column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-6" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Description</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(flights_data.__doc__)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-8" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>flights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>517.00</td>
<td>515</td>
<td>2.00</td>
<td>830.00</td>
<td>819</td>
<td>11.00</td>
<td>UA</td>
<td>1545</td>
<td>N14228</td>
<td>EWR</td>
<td>IAH</td>
<td>227.00</td>
<td>1400</td>
<td>5</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>533.00</td>
<td>529</td>
<td>4.00</td>
<td>850.00</td>
<td>830</td>
<td>20.00</td>
<td>UA</td>
<td>1714</td>
<td>N24211</td>
<td>LGA</td>
<td>IAH</td>
<td>227.00</td>
<td>1416</td>
<td>5</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>542.00</td>
<td>540</td>
<td>2.00</td>
<td>923.00</td>
<td>850</td>
<td>33.00</td>
<td>AA</td>
<td>1141</td>
<td>N619AA</td>
<td>JFK</td>
<td>MIA</td>
<td>160.00</td>
<td>1089</td>
<td>5</td>
<td>40</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336773</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>NaN</td>
<td>1210</td>
<td>NaN</td>
<td>NaN</td>
<td>1330</td>
<td>NaN</td>
<td>MQ</td>
<td>3461</td>
<td>N535MQ</td>
<td>LGA</td>
<td>BNA</td>
<td>NaN</td>
<td>764</td>
<td>12</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">336774</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>NaN</td>
<td>1159</td>
<td>NaN</td>
<td>NaN</td>
<td>1344</td>
<td>NaN</td>
<td>MQ</td>
<td>3572</td>
<td>N511MQ</td>
<td>LGA</td>
<td>CLE</td>
<td>NaN</td>
<td>419</td>
<td>11</td>
<td>59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336775</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>NaN</td>
<td>840</td>
<td>NaN</td>
<td>NaN</td>
<td>1020</td>
<td>NaN</td>
<td>MQ</td>
<td>3531</td>
<td>N839MQ</td>
<td>LGA</td>
<td>RDU</td>
<td>NaN</td>
<td>431</td>
<td>8</td>
<td>40</td>
</tr>
</tbody>
</table>

<p>336776 rows × 18 columns</p>
</div>
</div>
</div>
<div id="cell-9" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>flights.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 336776 entries, 0 to 336775
Data columns (total 18 columns):
 #   Column          Non-Null Count   Dtype  
---  ------          --------------   -----  
 0   year            336776 non-null  int64  
 1   month           336776 non-null  int64  
 2   day             336776 non-null  int64  
 3   dep_time        328521 non-null  float64
 4   sched_dep_time  336776 non-null  int64  
 5   dep_delay       328521 non-null  float64
 6   arr_time        328063 non-null  float64
 7   sched_arr_time  336776 non-null  int64  
 8   arr_delay       327346 non-null  float64
 9   carrier         336776 non-null  object 
 10  flight          336776 non-null  int64  
 11  tailnum         334264 non-null  object 
 12  origin          336776 non-null  object 
 13  dest            336776 non-null  object 
 14  air_time        327346 non-null  float64
 15  distance        336776 non-null  int64  
 16  hour            336776 non-null  int64  
 17  minute          336776 non-null  int64  
dtypes: float64(5), int64(9), object(4)
memory usage: 46.2+ MB</code></pre>
</div>
</div>
<section id="rows" class="level2">
<h2 class="anchored" data-anchor-id="rows">Rows</h2>
<section id="query" class="level3">
<h3 class="anchored" data-anchor-id="query"><code>query()</code></h3>
<p><a href="https://pandas.pydata.org/docs/user_guide/indexing.html#the-query-method">The query() Method 참조</a></p>
<blockquote class="blockquote">
<p>Conditional operators<br>
&gt;, &nbsp;&gt;=, &nbsp;&lt;, &nbsp;&lt;=,<br>
== &nbsp;(equal to), &nbsp;!= &nbsp;(not equal to)<br>
<code>and</code>, <code>&amp;</code> (and)<br>
<code>or</code>, <code>|</code> (or)<br>
<code>not</code>, <code>~</code> (not)<br>
<code>in</code> (includes), <code>not in</code> (not included)</p>
</blockquote>
<div id="cell-12" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Flights that arrived more than 120 minutes (two hours) late</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>flights.query(<span class="st">'arr_delay &gt; 120'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">119</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>811.00</td>
<td>630</td>
<td>101.00</td>
<td>1047.00</td>
<td>830</td>
<td>137.00</td>
<td>MQ</td>
<td>4576</td>
<td>N531MQ</td>
<td>LGA</td>
<td>CLT</td>
<td>118.00</td>
<td>544</td>
<td>6</td>
<td>30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">151</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>848.00</td>
<td>1835</td>
<td>853.00</td>
<td>1001.00</td>
<td>1950</td>
<td>851.00</td>
<td>MQ</td>
<td>3944</td>
<td>N942MQ</td>
<td>JFK</td>
<td>BWI</td>
<td>41.00</td>
<td>184</td>
<td>18</td>
<td>35</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">218</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>957.00</td>
<td>733</td>
<td>144.00</td>
<td>1056.00</td>
<td>853</td>
<td>123.00</td>
<td>UA</td>
<td>856</td>
<td>N534UA</td>
<td>EWR</td>
<td>BOS</td>
<td>37.00</td>
<td>200</td>
<td>7</td>
<td>33</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336724</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>2053.00</td>
<td>1815</td>
<td>158.00</td>
<td>2310.00</td>
<td>2054</td>
<td>136.00</td>
<td>EV</td>
<td>5292</td>
<td>N600QX</td>
<td>EWR</td>
<td>ATL</td>
<td>91.00</td>
<td>746</td>
<td>18</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">336757</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>2159.00</td>
<td>1845</td>
<td>194.00</td>
<td>2344.00</td>
<td>2030</td>
<td>194.00</td>
<td>9E</td>
<td>3320</td>
<td>N906XJ</td>
<td>JFK</td>
<td>BUF</td>
<td>50.00</td>
<td>301</td>
<td>18</td>
<td>45</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336763</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>2235.00</td>
<td>2001</td>
<td>154.00</td>
<td>59.00</td>
<td>2249</td>
<td>130.00</td>
<td>B6</td>
<td>1083</td>
<td>N804JB</td>
<td>JFK</td>
<td>MCO</td>
<td>123.00</td>
<td>944</td>
<td>20</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>10034 rows × 18 columns</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>외부 변수/함수를 참조하려면 <span class="citation" data-cites="와">@와</span> 함께</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>delay_cutoff <span class="op">=</span> <span class="dv">120</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>flights.query(<span class="st">'arr_delay &gt; @delay_cutoff'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cut_off(df):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df[<span class="st">"dep_delay"</span>].<span class="bu">min</span>()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>flights.query(<span class="st">'arr_delay &lt; @cut_off(@flights)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>위의 query 방식의 filtering은 다음과 같은 boolean indexing의 결과와 같음<br>
<code>flights[flights["arr_delay"] &gt; 120]</code></p>
</div>
</div>
<div id="cell-14" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Flights that departed on January 1</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>flights.query(<span class="st">'month == 1 and day == 1'</span>)  <span class="co"># == 과 = 을 혼동하지 말것!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>517.00</td>
<td>515</td>
<td>2.00</td>
<td>830.00</td>
<td>819</td>
<td>11.00</td>
<td>UA</td>
<td>1545</td>
<td>N14228</td>
<td>EWR</td>
<td>IAH</td>
<td>227.00</td>
<td>1400</td>
<td>5</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>533.00</td>
<td>529</td>
<td>4.00</td>
<td>850.00</td>
<td>830</td>
<td>20.00</td>
<td>UA</td>
<td>1714</td>
<td>N24211</td>
<td>LGA</td>
<td>IAH</td>
<td>227.00</td>
<td>1416</td>
<td>5</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>542.00</td>
<td>540</td>
<td>2.00</td>
<td>923.00</td>
<td>850</td>
<td>33.00</td>
<td>AA</td>
<td>1141</td>
<td>N619AA</td>
<td>JFK</td>
<td>MIA</td>
<td>160.00</td>
<td>1089</td>
<td>5</td>
<td>40</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">839</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>1935</td>
<td>NaN</td>
<td>NaN</td>
<td>2240</td>
<td>NaN</td>
<td>AA</td>
<td>791</td>
<td>N3EHAA</td>
<td>LGA</td>
<td>DFW</td>
<td>NaN</td>
<td>1389</td>
<td>19</td>
<td>35</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">840</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>1500</td>
<td>NaN</td>
<td>NaN</td>
<td>1825</td>
<td>NaN</td>
<td>AA</td>
<td>1925</td>
<td>N3EVAA</td>
<td>LGA</td>
<td>MIA</td>
<td>NaN</td>
<td>1096</td>
<td>15</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">841</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>600</td>
<td>NaN</td>
<td>NaN</td>
<td>901</td>
<td>NaN</td>
<td>B6</td>
<td>125</td>
<td>N618JB</td>
<td>JFK</td>
<td>FLL</td>
<td>NaN</td>
<td>1069</td>
<td>6</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>842 rows × 18 columns</p>
</div>
</div>
</div>
<div id="cell-15" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Flights that departed in January or February</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>flights.query(<span class="st">'month == 1 or month == 2'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>517.00</td>
<td>515</td>
<td>2.00</td>
<td>830.00</td>
<td>819</td>
<td>11.00</td>
<td>UA</td>
<td>1545</td>
<td>N14228</td>
<td>EWR</td>
<td>IAH</td>
<td>227.00</td>
<td>1400</td>
<td>5</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>533.00</td>
<td>529</td>
<td>4.00</td>
<td>850.00</td>
<td>830</td>
<td>20.00</td>
<td>UA</td>
<td>1714</td>
<td>N24211</td>
<td>LGA</td>
<td>IAH</td>
<td>227.00</td>
<td>1416</td>
<td>5</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>542.00</td>
<td>540</td>
<td>2.00</td>
<td>923.00</td>
<td>850</td>
<td>33.00</td>
<td>AA</td>
<td>1141</td>
<td>N619AA</td>
<td>JFK</td>
<td>MIA</td>
<td>160.00</td>
<td>1089</td>
<td>5</td>
<td>40</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">136244</td>
<td>2013</td>
<td>2</td>
<td>28</td>
<td>NaN</td>
<td>1115</td>
<td>NaN</td>
<td>NaN</td>
<td>1310</td>
<td>NaN</td>
<td>MQ</td>
<td>4485</td>
<td>N725MQ</td>
<td>LGA</td>
<td>CMH</td>
<td>NaN</td>
<td>479</td>
<td>11</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">136245</td>
<td>2013</td>
<td>2</td>
<td>28</td>
<td>NaN</td>
<td>830</td>
<td>NaN</td>
<td>NaN</td>
<td>1205</td>
<td>NaN</td>
<td>UA</td>
<td>1480</td>
<td>NaN</td>
<td>EWR</td>
<td>SFO</td>
<td>NaN</td>
<td>2565</td>
<td>8</td>
<td>30</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">136246</td>
<td>2013</td>
<td>2</td>
<td>28</td>
<td>NaN</td>
<td>840</td>
<td>NaN</td>
<td>NaN</td>
<td>1147</td>
<td>NaN</td>
<td>UA</td>
<td>443</td>
<td>NaN</td>
<td>JFK</td>
<td>LAX</td>
<td>NaN</td>
<td>2475</td>
<td>8</td>
<td>40</td>
</tr>
</tbody>
</table>

<p>51955 rows × 18 columns</p>
</div>
</div>
</div>
<div id="cell-16" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A shorter way to select flights that departed in January or February</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>flights.query(<span class="st">'month in [1, 2]'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>517.00</td>
<td>515</td>
<td>2.00</td>
<td>830.00</td>
<td>819</td>
<td>11.00</td>
<td>UA</td>
<td>1545</td>
<td>N14228</td>
<td>EWR</td>
<td>IAH</td>
<td>227.00</td>
<td>1400</td>
<td>5</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>533.00</td>
<td>529</td>
<td>4.00</td>
<td>850.00</td>
<td>830</td>
<td>20.00</td>
<td>UA</td>
<td>1714</td>
<td>N24211</td>
<td>LGA</td>
<td>IAH</td>
<td>227.00</td>
<td>1416</td>
<td>5</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>542.00</td>
<td>540</td>
<td>2.00</td>
<td>923.00</td>
<td>850</td>
<td>33.00</td>
<td>AA</td>
<td>1141</td>
<td>N619AA</td>
<td>JFK</td>
<td>MIA</td>
<td>160.00</td>
<td>1089</td>
<td>5</td>
<td>40</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">136244</td>
<td>2013</td>
<td>2</td>
<td>28</td>
<td>NaN</td>
<td>1115</td>
<td>NaN</td>
<td>NaN</td>
<td>1310</td>
<td>NaN</td>
<td>MQ</td>
<td>4485</td>
<td>N725MQ</td>
<td>LGA</td>
<td>CMH</td>
<td>NaN</td>
<td>479</td>
<td>11</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">136245</td>
<td>2013</td>
<td>2</td>
<td>28</td>
<td>NaN</td>
<td>830</td>
<td>NaN</td>
<td>NaN</td>
<td>1205</td>
<td>NaN</td>
<td>UA</td>
<td>1480</td>
<td>NaN</td>
<td>EWR</td>
<td>SFO</td>
<td>NaN</td>
<td>2565</td>
<td>8</td>
<td>30</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">136246</td>
<td>2013</td>
<td>2</td>
<td>28</td>
<td>NaN</td>
<td>840</td>
<td>NaN</td>
<td>NaN</td>
<td>1147</td>
<td>NaN</td>
<td>UA</td>
<td>443</td>
<td>NaN</td>
<td>JFK</td>
<td>LAX</td>
<td>NaN</td>
<td>2475</td>
<td>8</td>
<td>40</td>
</tr>
</tbody>
</table>

<p>51955 rows × 18 columns</p>
</div>
</div>
</div>
<div id="cell-17" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>flights.query(<span class="st">'arr_delay &gt; 120 and not (origin == "JFK")'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">119</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>811.00</td>
<td>630</td>
<td>101.00</td>
<td>1047.00</td>
<td>830</td>
<td>137.00</td>
<td>MQ</td>
<td>4576</td>
<td>N531MQ</td>
<td>LGA</td>
<td>CLT</td>
<td>118.00</td>
<td>544</td>
<td>6</td>
<td>30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">218</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>957.00</td>
<td>733</td>
<td>144.00</td>
<td>1056.00</td>
<td>853</td>
<td>123.00</td>
<td>UA</td>
<td>856</td>
<td>N534UA</td>
<td>EWR</td>
<td>BOS</td>
<td>37.00</td>
<td>200</td>
<td>7</td>
<td>33</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">268</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>1114.00</td>
<td>900</td>
<td>134.00</td>
<td>1447.00</td>
<td>1222</td>
<td>145.00</td>
<td>UA</td>
<td>1086</td>
<td>N76502</td>
<td>LGA</td>
<td>IAH</td>
<td>248.00</td>
<td>1416</td>
<td>9</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336529</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>1738.00</td>
<td>1529</td>
<td>129.00</td>
<td>1906.00</td>
<td>1649</td>
<td>137.00</td>
<td>EV</td>
<td>4580</td>
<td>N12563</td>
<td>EWR</td>
<td>MKE</td>
<td>110.00</td>
<td>725</td>
<td>15</td>
<td>29</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">336668</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>1951.00</td>
<td>1649</td>
<td>182.00</td>
<td>2157.00</td>
<td>1903</td>
<td>174.00</td>
<td>EV</td>
<td>4294</td>
<td>N13988</td>
<td>EWR</td>
<td>SAV</td>
<td>95.00</td>
<td>708</td>
<td>16</td>
<td>49</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336724</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>2053.00</td>
<td>1815</td>
<td>158.00</td>
<td>2310.00</td>
<td>2054</td>
<td>136.00</td>
<td>EV</td>
<td>5292</td>
<td>N600QX</td>
<td>EWR</td>
<td>ATL</td>
<td>91.00</td>
<td>746</td>
<td>18</td>
<td>15</td>
</tr>
</tbody>
</table>

<p>6868 rows × 18 columns</p>
</div>
</div>
</div>
<div id="cell-18" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>flights.query(<span class="st">'dep_time &lt; sched_dep_time'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>544.00</td>
<td>545</td>
<td>-1.00</td>
<td>1004.00</td>
<td>1022</td>
<td>-18.00</td>
<td>B6</td>
<td>725</td>
<td>N804JB</td>
<td>JFK</td>
<td>BQN</td>
<td>183.00</td>
<td>1576</td>
<td>5</td>
<td>45</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>554.00</td>
<td>600</td>
<td>-6.00</td>
<td>812.00</td>
<td>837</td>
<td>-25.00</td>
<td>DL</td>
<td>461</td>
<td>N668DN</td>
<td>LGA</td>
<td>ATL</td>
<td>116.00</td>
<td>762</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>554.00</td>
<td>558</td>
<td>-4.00</td>
<td>740.00</td>
<td>728</td>
<td>12.00</td>
<td>UA</td>
<td>1696</td>
<td>N39463</td>
<td>EWR</td>
<td>ORD</td>
<td>150.00</td>
<td>719</td>
<td>5</td>
<td>58</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336766</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>2240.00</td>
<td>2250</td>
<td>-10.00</td>
<td>2347.00</td>
<td>7</td>
<td>-20.00</td>
<td>B6</td>
<td>2002</td>
<td>N281JB</td>
<td>JFK</td>
<td>BUF</td>
<td>52.00</td>
<td>301</td>
<td>22</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">336767</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>2241.00</td>
<td>2246</td>
<td>-5.00</td>
<td>2345.00</td>
<td>1</td>
<td>-16.00</td>
<td>B6</td>
<td>486</td>
<td>N346JB</td>
<td>JFK</td>
<td>ROC</td>
<td>47.00</td>
<td>264</td>
<td>22</td>
<td>46</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336769</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>2349.00</td>
<td>2359</td>
<td>-10.00</td>
<td>325.00</td>
<td>350</td>
<td>-25.00</td>
<td>B6</td>
<td>745</td>
<td>N516JB</td>
<td>JFK</td>
<td>PSE</td>
<td>196.00</td>
<td>1617</td>
<td>23</td>
<td>59</td>
</tr>
</tbody>
</table>

<p>184782 rows × 18 columns</p>
</div>
</div>
</div>
<div id="cell-19" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>flights.query(<span class="st">'arr_delay + dep_delay &lt; 0'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>544.00</td>
<td>545</td>
<td>-1.00</td>
<td>1004.00</td>
<td>1022</td>
<td>-18.00</td>
<td>B6</td>
<td>725</td>
<td>N804JB</td>
<td>JFK</td>
<td>BQN</td>
<td>183.00</td>
<td>1576</td>
<td>5</td>
<td>45</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>554.00</td>
<td>600</td>
<td>-6.00</td>
<td>812.00</td>
<td>837</td>
<td>-25.00</td>
<td>DL</td>
<td>461</td>
<td>N668DN</td>
<td>LGA</td>
<td>ATL</td>
<td>116.00</td>
<td>762</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>557.00</td>
<td>600</td>
<td>-3.00</td>
<td>709.00</td>
<td>723</td>
<td>-14.00</td>
<td>EV</td>
<td>5708</td>
<td>N829AS</td>
<td>LGA</td>
<td>IAD</td>
<td>53.00</td>
<td>229</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336766</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>2240.00</td>
<td>2250</td>
<td>-10.00</td>
<td>2347.00</td>
<td>7</td>
<td>-20.00</td>
<td>B6</td>
<td>2002</td>
<td>N281JB</td>
<td>JFK</td>
<td>BUF</td>
<td>52.00</td>
<td>301</td>
<td>22</td>
<td>50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">336767</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>2241.00</td>
<td>2246</td>
<td>-5.00</td>
<td>2345.00</td>
<td>1</td>
<td>-16.00</td>
<td>B6</td>
<td>486</td>
<td>N346JB</td>
<td>JFK</td>
<td>ROC</td>
<td>47.00</td>
<td>264</td>
<td>22</td>
<td>46</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336769</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>2349.00</td>
<td>2359</td>
<td>-10.00</td>
<td>325.00</td>
<td>350</td>
<td>-25.00</td>
<td>B6</td>
<td>745</td>
<td>N516JB</td>
<td>JFK</td>
<td>PSE</td>
<td>196.00</td>
<td>1617</td>
<td>23</td>
<td>59</td>
</tr>
</tbody>
</table>

<p>188401 rows × 18 columns</p>
</div>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>flights.query(<span class="st">'not dep_delay.isna() and arr_delay.isna()'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">471</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>1525.00</td>
<td>1530</td>
<td>-5.00</td>
<td>1934.00</td>
<td>1805</td>
<td>NaN</td>
<td>MQ</td>
<td>4525</td>
<td>N719MQ</td>
<td>LGA</td>
<td>XNA</td>
<td>NaN</td>
<td>1147</td>
<td>15</td>
<td>30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">477</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>1528.00</td>
<td>1459</td>
<td>29.00</td>
<td>2002.00</td>
<td>1647</td>
<td>NaN</td>
<td>EV</td>
<td>3806</td>
<td>N17108</td>
<td>EWR</td>
<td>STL</td>
<td>NaN</td>
<td>872</td>
<td>14</td>
<td>59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">615</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>1740.00</td>
<td>1745</td>
<td>-5.00</td>
<td>2158.00</td>
<td>2020</td>
<td>NaN</td>
<td>MQ</td>
<td>4413</td>
<td>N739MQ</td>
<td>LGA</td>
<td>XNA</td>
<td>NaN</td>
<td>1147</td>
<td>17</td>
<td>45</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">334495</td>
<td>2013</td>
<td>9</td>
<td>28</td>
<td>1214.00</td>
<td>1225</td>
<td>-11.00</td>
<td>1801.00</td>
<td>1510</td>
<td>NaN</td>
<td>AA</td>
<td>300</td>
<td>N488AA</td>
<td>EWR</td>
<td>DFW</td>
<td>NaN</td>
<td>1372</td>
<td>12</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">335534</td>
<td>2013</td>
<td>9</td>
<td>29</td>
<td>1734.00</td>
<td>1711</td>
<td>23.00</td>
<td>2159.00</td>
<td>2020</td>
<td>NaN</td>
<td>UA</td>
<td>327</td>
<td>N463UA</td>
<td>EWR</td>
<td>PDX</td>
<td>NaN</td>
<td>2434</td>
<td>17</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">335805</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>559.00</td>
<td>600</td>
<td>-1.00</td>
<td>NaN</td>
<td>715</td>
<td>NaN</td>
<td>WN</td>
<td>464</td>
<td>N411WN</td>
<td>EWR</td>
<td>MDW</td>
<td>NaN</td>
<td>711</td>
<td>6</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>1175 rows × 18 columns</p>
</div>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>delay_time <span class="op">=</span> <span class="dv">900</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>flights.query(<span class="st">'arr_delay &gt; @delay_time'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">7072</td>
<td>2013</td>
<td>1</td>
<td>9</td>
<td>641.00</td>
<td>900</td>
<td>1301.00</td>
<td>1242.00</td>
<td>1530</td>
<td>1272.00</td>
<td>HA</td>
<td>51</td>
<td>N384HA</td>
<td>JFK</td>
<td>HNL</td>
<td>640.00</td>
<td>4983</td>
<td>9</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8239</td>
<td>2013</td>
<td>1</td>
<td>10</td>
<td>1121.00</td>
<td>1635</td>
<td>1126.00</td>
<td>1239.00</td>
<td>1810</td>
<td>1109.00</td>
<td>MQ</td>
<td>3695</td>
<td>N517MQ</td>
<td>EWR</td>
<td>ORD</td>
<td>111.00</td>
<td>719</td>
<td>16</td>
<td>35</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">151974</td>
<td>2013</td>
<td>3</td>
<td>17</td>
<td>2321.00</td>
<td>810</td>
<td>911.00</td>
<td>135.00</td>
<td>1020</td>
<td>915.00</td>
<td>DL</td>
<td>2119</td>
<td>N927DA</td>
<td>LGA</td>
<td>MSP</td>
<td>167.00</td>
<td>1020</td>
<td>8</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">173992</td>
<td>2013</td>
<td>4</td>
<td>10</td>
<td>1100.00</td>
<td>1900</td>
<td>960.00</td>
<td>1342.00</td>
<td>2211</td>
<td>931.00</td>
<td>DL</td>
<td>2391</td>
<td>N959DL</td>
<td>JFK</td>
<td>TPA</td>
<td>139.00</td>
<td>1005</td>
<td>19</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">235778</td>
<td>2013</td>
<td>6</td>
<td>15</td>
<td>1432.00</td>
<td>1935</td>
<td>1137.00</td>
<td>1607.00</td>
<td>2120</td>
<td>1127.00</td>
<td>MQ</td>
<td>3535</td>
<td>N504MQ</td>
<td>JFK</td>
<td>CMH</td>
<td>74.00</td>
<td>483</td>
<td>19</td>
<td>35</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">270376</td>
<td>2013</td>
<td>7</td>
<td>22</td>
<td>845.00</td>
<td>1600</td>
<td>1005.00</td>
<td>1044.00</td>
<td>1815</td>
<td>989.00</td>
<td>MQ</td>
<td>3075</td>
<td>N665MQ</td>
<td>JFK</td>
<td>CVG</td>
<td>96.00</td>
<td>589</td>
<td>16</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">327043</td>
<td>2013</td>
<td>9</td>
<td>20</td>
<td>1139.00</td>
<td>1845</td>
<td>1014.00</td>
<td>1457.00</td>
<td>2210</td>
<td>1007.00</td>
<td>AA</td>
<td>177</td>
<td>N338AA</td>
<td>JFK</td>
<td>SFO</td>
<td>354.00</td>
<td>2586</td>
<td>18</td>
<td>45</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><code>.query()</code>의 결과는 view이므로 수정하려면 SettingWithCopyWarning; <code>.copy()</code> 후 사용 권장</li>
<li>Python에서 유효하지 않은 변수명의 경우, 예를 들어, 빈칸이나 .이 있는 경우; <code>income total</code>, <code>income.total</code><br>
Backtick으로 감싸줘야 함; `income total`, `income.total`, `class`</li>
<li>Index값을 사용하여 query할 경우, <a href="https://pandas.pydata.org/docs/user_guide/indexing.html#the-query-method">문서 참고</a></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>query()</code> 조건의 참거짓에 상관없이 NA값은 모두 제외함
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df가 다음과 같을 때,</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#      A     B</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 1.00  2.00</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1  NaN  5.00</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 3.00  3.00</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 4.00   NaN</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>df.query(<span class="st">'A &gt; 1'</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#      A     B</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 3.00  3.00</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 4.00   NaN</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># NA를 포함하고자 할 때,</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>df.query(<span class="st">'A &gt; 1 | A.isna()'</span>) <span class="co"># .isna() : NA인지 여부</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#      A     B</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 1  NaN  5.00</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 3.00  3.00</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 4.00   NaN</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>NA</code>(missing)에 대해서는 뒤에서 자세히</p>
</div>
</div>
</div>
</section>
<section id="sort_values" class="level3">
<h3 class="anchored" data-anchor-id="sort_values"><code>sort_values()</code></h3>
<div id="cell-26" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># "year", "month", "day", "dep_time" 순서대로 내림차순으로 정렬</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>flights.sort_values(by<span class="op">=</span>[<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>, <span class="st">"dep_time"</span>], ascending<span class="op">=</span><span class="va">False</span>)   <span class="co"># default: ascending=True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">111279</td>
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2356.00</td>
<td>2359</td>
<td>-3.00</td>
<td>436.00</td>
<td>445</td>
<td>-9.00</td>
<td>B6</td>
<td>745</td>
<td>N665JB</td>
<td>JFK</td>
<td>PSE</td>
<td>200.00</td>
<td>1617</td>
<td>23</td>
<td>59</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">111278</td>
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2355.00</td>
<td>2359</td>
<td>-4.00</td>
<td>430.00</td>
<td>440</td>
<td>-10.00</td>
<td>B6</td>
<td>1503</td>
<td>N509JB</td>
<td>JFK</td>
<td>SJU</td>
<td>195.00</td>
<td>1598</td>
<td>23</td>
<td>59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">111277</td>
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2332.00</td>
<td>2245</td>
<td>47.00</td>
<td>58.00</td>
<td>3</td>
<td>55.00</td>
<td>B6</td>
<td>486</td>
<td>N334JB</td>
<td>JFK</td>
<td>ROC</td>
<td>60.00</td>
<td>264</td>
<td>22</td>
<td>45</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">839</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>1935</td>
<td>NaN</td>
<td>NaN</td>
<td>2240</td>
<td>NaN</td>
<td>AA</td>
<td>791</td>
<td>N3EHAA</td>
<td>LGA</td>
<td>DFW</td>
<td>NaN</td>
<td>1389</td>
<td>19</td>
<td>35</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">840</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>1500</td>
<td>NaN</td>
<td>NaN</td>
<td>1825</td>
<td>NaN</td>
<td>AA</td>
<td>1925</td>
<td>N3EVAA</td>
<td>LGA</td>
<td>MIA</td>
<td>NaN</td>
<td>1096</td>
<td>15</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">841</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>NaN</td>
<td>600</td>
<td>NaN</td>
<td>NaN</td>
<td>901</td>
<td>NaN</td>
<td>B6</td>
<td>125</td>
<td>N618JB</td>
<td>JFK</td>
<td>FLL</td>
<td>NaN</td>
<td>1069</td>
<td>6</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>336776 rows × 18 columns</p>
</div>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pd.DataFrame.nlargest()를 이용할 수도 있음</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>flights.nlargest(<span class="dv">3</span>, columns<span class="op">=</span>[<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>, <span class="st">"dep_time"</span>], keep<span class="op">=</span><span class="st">"all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">111279</td>
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2356.00</td>
<td>2359</td>
<td>-3.00</td>
<td>436.00</td>
<td>445</td>
<td>-9.00</td>
<td>B6</td>
<td>745</td>
<td>N665JB</td>
<td>JFK</td>
<td>PSE</td>
<td>200.00</td>
<td>1617</td>
<td>23</td>
<td>59</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">111278</td>
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2355.00</td>
<td>2359</td>
<td>-4.00</td>
<td>430.00</td>
<td>440</td>
<td>-10.00</td>
<td>B6</td>
<td>1503</td>
<td>N509JB</td>
<td>JFK</td>
<td>SJU</td>
<td>195.00</td>
<td>1598</td>
<td>23</td>
<td>59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">111277</td>
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2332.00</td>
<td>2245</td>
<td>47.00</td>
<td>58.00</td>
<td>3</td>
<td>55.00</td>
<td>B6</td>
<td>486</td>
<td>N334JB</td>
<td>JFK</td>
<td>ROC</td>
<td>60.00</td>
<td>264</td>
<td>22</td>
<td>45</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>method의 설명이 잘 나타나지 않을 시, 함수를 직접 써서 확인<br>
예를 들어,<br>
<code>pd.DataFrame.nlargest</code><br>
<code>pd.Series.nlargest</code></p>
</div>
</div>
<div id="cell-29" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># "dep_time"은 내림차순으로, "arr_delay"는 오름차순으로</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>flights.sort_values(by<span class="op">=</span>[<span class="st">"dep_time"</span>, <span class="st">"arr_delay"</span>], ascending<span class="op">=</span>[<span class="va">False</span>, <span class="va">True</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">150301</td>
<td>2013</td>
<td>3</td>
<td>15</td>
<td>2400.00</td>
<td>2359</td>
<td>1.00</td>
<td>324.00</td>
<td>338</td>
<td>-14.00</td>
<td>B6</td>
<td>727</td>
<td>N636JB</td>
<td>JFK</td>
<td>BQN</td>
<td>186.00</td>
<td>1576</td>
<td>23</td>
<td>59</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">87893</td>
<td>2013</td>
<td>12</td>
<td>5</td>
<td>2400.00</td>
<td>2359</td>
<td>1.00</td>
<td>427.00</td>
<td>440</td>
<td>-13.00</td>
<td>B6</td>
<td>1503</td>
<td>N587JB</td>
<td>JFK</td>
<td>SJU</td>
<td>182.00</td>
<td>1598</td>
<td>23</td>
<td>59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">212941</td>
<td>2013</td>
<td>5</td>
<td>21</td>
<td>2400.00</td>
<td>2359</td>
<td>1.00</td>
<td>339.00</td>
<td>350</td>
<td>-11.00</td>
<td>B6</td>
<td>739</td>
<td>N527JB</td>
<td>JFK</td>
<td>PSE</td>
<td>199.00</td>
<td>1617</td>
<td>23</td>
<td>59</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336773</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>NaN</td>
<td>1210</td>
<td>NaN</td>
<td>NaN</td>
<td>1330</td>
<td>NaN</td>
<td>MQ</td>
<td>3461</td>
<td>N535MQ</td>
<td>LGA</td>
<td>BNA</td>
<td>NaN</td>
<td>764</td>
<td>12</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">336774</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>NaN</td>
<td>1159</td>
<td>NaN</td>
<td>NaN</td>
<td>1344</td>
<td>NaN</td>
<td>MQ</td>
<td>3572</td>
<td>N511MQ</td>
<td>LGA</td>
<td>CLE</td>
<td>NaN</td>
<td>419</td>
<td>11</td>
<td>59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336775</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>NaN</td>
<td>840</td>
<td>NaN</td>
<td>NaN</td>
<td>1020</td>
<td>NaN</td>
<td>MQ</td>
<td>3531</td>
<td>N839MQ</td>
<td>LGA</td>
<td>RDU</td>
<td>NaN</td>
<td>431</td>
<td>8</td>
<td>40</td>
</tr>
</tbody>
</table>

<p>336776 rows × 18 columns</p>
</div>
</div>
</div>
<p><br> <code>query()</code>와 <code>sort_values()</code>을 함께 이용하여 좀 더 복잡한 문제를 해결할 수 있음<br>
예를 들어, 다음과 같이 거의 제시간에 출발한(+- 10분 이내) 항공편들 중 가장 도착 지연이 큰 항공편을 찾을 수 있음</p>
<div id="cell-31" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Method chaining</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    flights</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    .query(<span class="st">'dep_delay &lt;= 10 &amp; dep_delay &gt;= -10'</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">"arr_delay"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">55985</td>
<td>2013</td>
<td>11</td>
<td>1</td>
<td>658.00</td>
<td>700</td>
<td>-2.00</td>
<td>1329.00</td>
<td>1015</td>
<td>194.00</td>
<td>VX</td>
<td>399</td>
<td>N629VA</td>
<td>JFK</td>
<td>LAX</td>
<td>336.00</td>
<td>2475</td>
<td>7</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">181270</td>
<td>2013</td>
<td>4</td>
<td>18</td>
<td>558.00</td>
<td>600</td>
<td>-2.00</td>
<td>1149.00</td>
<td>850</td>
<td>179.00</td>
<td>AA</td>
<td>707</td>
<td>N3EXAA</td>
<td>LGA</td>
<td>DFW</td>
<td>234.00</td>
<td>1389</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">256340</td>
<td>2013</td>
<td>7</td>
<td>7</td>
<td>1659.00</td>
<td>1700</td>
<td>-1.00</td>
<td>2050.00</td>
<td>1823</td>
<td>147.00</td>
<td>US</td>
<td>2183</td>
<td>N948UW</td>
<td>LGA</td>
<td>DCA</td>
<td>64.00</td>
<td>214</td>
<td>17</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">334354</td>
<td>2013</td>
<td>9</td>
<td>28</td>
<td>847.00</td>
<td>839</td>
<td>8.00</td>
<td>1130.00</td>
<td>959</td>
<td>NaN</td>
<td>EV</td>
<td>4510</td>
<td>N14542</td>
<td>EWR</td>
<td>MKE</td>
<td>NaN</td>
<td>725</td>
<td>8</td>
<td>39</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">334412</td>
<td>2013</td>
<td>9</td>
<td>28</td>
<td>1010.00</td>
<td>1020</td>
<td>-10.00</td>
<td>1344.00</td>
<td>1222</td>
<td>NaN</td>
<td>EV</td>
<td>4412</td>
<td>N12175</td>
<td>EWR</td>
<td>DSM</td>
<td>NaN</td>
<td>1017</td>
<td>10</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">335805</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>559.00</td>
<td>600</td>
<td>-1.00</td>
<td>NaN</td>
<td>715</td>
<td>NaN</td>
<td>WN</td>
<td>464</td>
<td>N411WN</td>
<td>EWR</td>
<td>MDW</td>
<td>NaN</td>
<td>711</td>
<td>6</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>239109 rows × 18 columns</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="`sort_values()` 파라미터">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>sort_values()</code> 파라미터
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Row가 재정렬되는 operation을 한 후에는 index 순서가 바뀌는데, 이를 reset하려면,<br>
<code>.sort_values(ignore_index=True)</code></li>
<li>DataFrame updated: <code>inplace=True</code></li>
<li><code>NA</code>는 sort 후 맨 뒤로<br>
맨 앞으로 오게하려면 <code>na_position='first'</code></li>
</ul>
</div>
</div>
</section>
<section id="unique" class="level3">
<h3 class="anchored" data-anchor-id="unique"><code>unique()</code></h3>
<p>Series method</p>
<div id="cell-35" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>flights[<span class="st">"origin"</span>].unique()  <span class="co"># return as a NumPy array, but depends on the dtypes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>array(['EWR', 'LGA', 'JFK'], dtype=object)</code></pre>
</div>
</div>
<div id="cell-36" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>flights[<span class="st">"origin"</span>].nunique()  <span class="co"># return the number of unique values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>3</code></pre>
</div>
</div>
<div id="cell-37" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># finds all unique origin and destination pairs.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>flights[[<span class="st">"origin"</span>, <span class="st">"dest"</span>]].value_counts(sort<span class="op">=</span><span class="va">False</span>)  <span class="co"># default: dropna=True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>origin  dest
EWR     ALB      439
        ANC        8
        ATL     5022
                ... 
LGA     TVC       77
        TYS      308
        XNA      745
Name: count, Length: 224, dtype: int64</code></pre>
</div>
</div>
<div id="cell-38" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>flights[[<span class="st">"origin"</span>, <span class="st">"dest"</span>]].value_counts(sort<span class="op">=</span><span class="va">False</span>).reset_index(name<span class="op">=</span><span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>    origin dest     n
0      EWR  ALB   439
1      EWR  ANC     8
2      EWR  ATL  5022
..     ...  ...   ...
221    LGA  TVC    77
222    LGA  TYS   308
223    LGA  XNA   745

[224 rows x 3 columns]</code></pre>
</div>
</div>
</section>
</section>
<section id="columns" class="level2">
<h2 class="anchored" data-anchor-id="columns">Columns</h2>
<section id="select" class="level3">
<h3 class="anchored" data-anchor-id="select">Select</h3>
<p>기본적인 column selection은 이전 섹션 참고: <a href="../../contents/Transform/subsetting.html">subsetting</a></p>
<div id="cell-41" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select columns by name</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>flights[[<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>        year  month  day
0       2013      1    1
1       2013      1    1
2       2013      1    1
...      ...    ...  ...
336773  2013      9   30
336774  2013      9   30
336775  2013      9   30

[336776 rows x 3 columns]</code></pre>
</div>
</div>
<div id="cell-42" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select all columns between year and day (inclusive)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>flights.loc[:, <span class="st">"year"</span>:<span class="st">"day"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<pre><code>        year  month  day
0       2013      1    1
1       2013      1    1
2       2013      1    1
...      ...    ...  ...
336773  2013      9   30
336774  2013      9   30
336775  2013      9   30

[336776 rows x 3 columns]</code></pre>
</div>
</div>
<div id="cell-44" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select all columns except those from year to day (inclusive)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># .isin(): includes</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>flights.loc[:, <span class="op">~</span>flights.columns.isin([<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>])]  <span class="co"># Boolean indexing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>517.00</td>
<td>515</td>
<td>2.00</td>
<td>830.00</td>
<td>819</td>
<td>11.00</td>
<td>UA</td>
<td>1545</td>
<td>N14228</td>
<td>EWR</td>
<td>IAH</td>
<td>227.00</td>
<td>1400</td>
<td>5</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>533.00</td>
<td>529</td>
<td>4.00</td>
<td>850.00</td>
<td>830</td>
<td>20.00</td>
<td>UA</td>
<td>1714</td>
<td>N24211</td>
<td>LGA</td>
<td>IAH</td>
<td>227.00</td>
<td>1416</td>
<td>5</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>542.00</td>
<td>540</td>
<td>2.00</td>
<td>923.00</td>
<td>850</td>
<td>33.00</td>
<td>AA</td>
<td>1141</td>
<td>N619AA</td>
<td>JFK</td>
<td>MIA</td>
<td>160.00</td>
<td>1089</td>
<td>5</td>
<td>40</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336773</td>
<td>NaN</td>
<td>1210</td>
<td>NaN</td>
<td>NaN</td>
<td>1330</td>
<td>NaN</td>
<td>MQ</td>
<td>3461</td>
<td>N535MQ</td>
<td>LGA</td>
<td>BNA</td>
<td>NaN</td>
<td>764</td>
<td>12</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">336774</td>
<td>NaN</td>
<td>1159</td>
<td>NaN</td>
<td>NaN</td>
<td>1344</td>
<td>NaN</td>
<td>MQ</td>
<td>3572</td>
<td>N511MQ</td>
<td>LGA</td>
<td>CLE</td>
<td>NaN</td>
<td>419</td>
<td>11</td>
<td>59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336775</td>
<td>NaN</td>
<td>840</td>
<td>NaN</td>
<td>NaN</td>
<td>1020</td>
<td>NaN</td>
<td>MQ</td>
<td>3531</td>
<td>N839MQ</td>
<td>LGA</td>
<td>RDU</td>
<td>NaN</td>
<td>431</td>
<td>8</td>
<td>40</td>
</tr>
</tbody>
</table>

<p>336776 rows × 15 columns</p>
</div>
</div>
</div>
<div id="cell-45" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> flights.columns <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> [<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>]]</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>flights[cols]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>        dep_time  sched_dep_time  dep_delay  arr_time  sched_arr_time  \
0         517.00             515       2.00    830.00             819   
1         533.00             529       4.00    850.00             830   
2         542.00             540       2.00    923.00             850   
...          ...             ...        ...       ...             ...   
336773       NaN            1210        NaN       NaN            1330   
336774       NaN            1159        NaN       NaN            1344   
336775       NaN             840        NaN       NaN            1020   

        arr_delay carrier  flight tailnum origin dest  air_time  distance  \
0           11.00      UA    1545  N14228    EWR  IAH    227.00      1400   
1           20.00      UA    1714  N24211    LGA  IAH    227.00      1416   
2           33.00      AA    1141  N619AA    JFK  MIA    160.00      1089   
...           ...     ...     ...     ...    ...  ...       ...       ...   
336773        NaN      MQ    3461  N535MQ    LGA  BNA       NaN       764   
336774        NaN      MQ    3572  N511MQ    LGA  CLE       NaN       419   
336775        NaN      MQ    3531  N839MQ    LGA  RDU       NaN       431   

        hour  minute  
0          5      15  
1          5      29  
2          5      40  
...      ...     ...  
336773    12      10  
336774    11      59  
336775     8      40  

[336776 rows x 15 columns]</code></pre>
</div>
</div>
<p><br> Series/Index object의 method와 함께 특정 string을 기준으로 선택 (string method와는 구별)<br>
<code>.str.contains()</code>, <code>.str.startswith()</code>, <code>.str.endswith()</code> ; True/False</p>
<div id="cell-48" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select all columns that begin with “dep”.</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>flights.loc[:, flights.columns.<span class="bu">str</span>.startswith(<span class="st">"dep"</span>)]  <span class="co"># Boolean indexing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>        dep_time  dep_delay
0         517.00       2.00
1         533.00       4.00
2         542.00       2.00
...          ...        ...
336773       NaN        NaN
336774       NaN        NaN
336775       NaN        NaN

[336776 rows x 2 columns]</code></pre>
</div>
</div>
<div id="cell-49" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select all columns that are characters</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>flights.select_dtypes(<span class="st">"object"</span>)  <span class="co"># dtype: object, number, ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>       carrier tailnum origin dest
0           UA  N14228    EWR  IAH
1           UA  N24211    LGA  IAH
2           AA  N619AA    JFK  MIA
...        ...     ...    ...  ...
336773      MQ  N535MQ    LGA  BNA
336774      MQ  N511MQ    LGA  CLE
336775      MQ  N839MQ    LGA  RDU

[336776 rows x 4 columns]</code></pre>
</div>
</div>
<p>index selection: reindex</p>
</section>
<section id="rename" class="level3">
<h3 class="anchored" data-anchor-id="rename"><code>rename()</code></h3>
<div id="cell-53" class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame.rename</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-54" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>flights.rename(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>{<span class="st">"dep_time"</span>: <span class="st">"dep_t"</span>, <span class="st">"arr_time"</span>: <span class="st">"arr_t"</span>},  </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 첫번째 인자 index=</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># inplace=True: dataframe is updated</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="97">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_t</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_t</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>517.00</td>
<td>515</td>
<td>2.00</td>
<td>830.00</td>
<td>819</td>
<td>11.00</td>
<td>UA</td>
<td>1545</td>
<td>N14228</td>
<td>EWR</td>
<td>IAH</td>
<td>227.00</td>
<td>1400</td>
<td>5</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>533.00</td>
<td>529</td>
<td>4.00</td>
<td>850.00</td>
<td>830</td>
<td>20.00</td>
<td>UA</td>
<td>1714</td>
<td>N24211</td>
<td>LGA</td>
<td>IAH</td>
<td>227.00</td>
<td>1416</td>
<td>5</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>542.00</td>
<td>540</td>
<td>2.00</td>
<td>923.00</td>
<td>850</td>
<td>33.00</td>
<td>AA</td>
<td>1141</td>
<td>N619AA</td>
<td>JFK</td>
<td>MIA</td>
<td>160.00</td>
<td>1089</td>
<td>5</td>
<td>40</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336773</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>NaN</td>
<td>1210</td>
<td>NaN</td>
<td>NaN</td>
<td>1330</td>
<td>NaN</td>
<td>MQ</td>
<td>3461</td>
<td>N535MQ</td>
<td>LGA</td>
<td>BNA</td>
<td>NaN</td>
<td>764</td>
<td>12</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">336774</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>NaN</td>
<td>1159</td>
<td>NaN</td>
<td>NaN</td>
<td>1344</td>
<td>NaN</td>
<td>MQ</td>
<td>3572</td>
<td>N511MQ</td>
<td>LGA</td>
<td>CLE</td>
<td>NaN</td>
<td>419</td>
<td>11</td>
<td>59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">336775</td>
<td>2013</td>
<td>9</td>
<td>30</td>
<td>NaN</td>
<td>840</td>
<td>NaN</td>
<td>NaN</td>
<td>1020</td>
<td>NaN</td>
<td>MQ</td>
<td>3531</td>
<td>N839MQ</td>
<td>LGA</td>
<td>RDU</td>
<td>NaN</td>
<td>431</td>
<td>8</td>
<td>40</td>
</tr>
</tbody>
</table>

<p>336776 rows × 18 columns</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>index를 rename할 수도 있음</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>flights.rename(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span>{<span class="dv">0</span>: <span class="st">"a"</span>, <span class="dv">1</span>: <span class="st">"b"</span>},</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>).head(<span class="dv">3</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co">#    year  month  day  dep_time  ...</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># a  2013      1    1    517.00  ...</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># b  2013      1    1    533.00  ...</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2  2013      1    1    542.00  ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Series의 경우</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> flights.dep_delay.head(<span class="dv">3</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0   2.00</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1   4.00</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2   2.00</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Name: dep_delay, dtype: float64</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>s.rename(<span class="st">"what"</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 0   2.00</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 1   4.00</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2   2.00</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Name: what, dtype: float64</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>함수 <code>str.capitalize</code>, <code>str.lower</code>, <code>str.upper</code>과 함께.</p>
<div id="cell-58" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>flights.rename(<span class="bu">str</span>.capitalize, axis<span class="op">=</span><span class="st">"columns"</span>).head(<span class="dv">3</span>)  <span class="co"># axis=1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="98">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Day</th>
<th data-quarto-table-cell-role="th">Dep_time</th>
<th data-quarto-table-cell-role="th">Sched_dep_time</th>
<th data-quarto-table-cell-role="th">Dep_delay</th>
<th data-quarto-table-cell-role="th">Arr_time</th>
<th data-quarto-table-cell-role="th">Sched_arr_time</th>
<th data-quarto-table-cell-role="th">Arr_delay</th>
<th data-quarto-table-cell-role="th">Carrier</th>
<th data-quarto-table-cell-role="th">Flight</th>
<th data-quarto-table-cell-role="th">Tailnum</th>
<th data-quarto-table-cell-role="th">Origin</th>
<th data-quarto-table-cell-role="th">Dest</th>
<th data-quarto-table-cell-role="th">Air_time</th>
<th data-quarto-table-cell-role="th">Distance</th>
<th data-quarto-table-cell-role="th">Hour</th>
<th data-quarto-table-cell-role="th">Minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>517.00</td>
<td>515</td>
<td>2.00</td>
<td>830.00</td>
<td>819</td>
<td>11.00</td>
<td>UA</td>
<td>1545</td>
<td>N14228</td>
<td>EWR</td>
<td>IAH</td>
<td>227.00</td>
<td>1400</td>
<td>5</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>533.00</td>
<td>529</td>
<td>4.00</td>
<td>850.00</td>
<td>830</td>
<td>20.00</td>
<td>UA</td>
<td>1714</td>
<td>N24211</td>
<td>LGA</td>
<td>IAH</td>
<td>227.00</td>
<td>1416</td>
<td>5</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>542.00</td>
<td>540</td>
<td>2.00</td>
<td>923.00</td>
<td>850</td>
<td>33.00</td>
<td>AA</td>
<td>1141</td>
<td>N619AA</td>
<td>JFK</td>
<td>MIA</td>
<td>160.00</td>
<td>1089</td>
<td>5</td>
<td>40</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>일반적으로 임의의 함수가 적용됨.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>flights.rename(<span class="kw">lambda</span> x: x[:<span class="dv">3</span>], axis<span class="op">=</span><span class="st">"columns"</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     yea  mon  day    dep  sch  dep    arr  sch   arr car   fli     tai  ori  ...</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 0  2013    1    1 517.00  515 2.00 830.00  819 11.00  UA  1545  N14228  EWR   </span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1  2013    1    1 533.00  529 4.00 850.00  830 20.00  UA  1714  N24211  LGA   </span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2  2013    1    1 542.00  540 2.00 923.00  850 33.00  AA  1141  N619AA  JFK  </span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="assign" class="level3">
<h3 class="anchored" data-anchor-id="assign"><code>assign()</code></h3>
<div id="cell-62" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>, <span class="st">"distance"</span>, <span class="st">"air_time"</span>] <span class="op">+</span> <span class="op">\</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>        [col <span class="cf">for</span> col <span class="kw">in</span> flights.columns <span class="cf">if</span> col.endswith(<span class="st">"delay"</span>)]  <span class="co"># string method .endswith</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>flights_sml <span class="op">=</span> flights[cols].copy()</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>flights_sml</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>        year  month  day  distance  air_time  dep_delay  arr_delay
0       2013      1    1      1400    227.00       2.00      11.00
1       2013      1    1      1416    227.00       4.00      20.00
2       2013      1    1      1089    160.00       2.00      33.00
...      ...    ...  ...       ...       ...        ...        ...
336773  2013      9   30       764       NaN        NaN        NaN
336774  2013      9   30       419       NaN        NaN        NaN
336775  2013      9   30       431       NaN        NaN        NaN

[336776 rows x 7 columns]</code></pre>
</div>
</div>
<div id="cell-63" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 새로 만들어진 변수는 맨 뒤로</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>flights_sml.assign(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    gain<span class="op">=</span><span class="kw">lambda</span> x: x.dep_delay <span class="op">-</span> x.arr_delay,   <span class="co"># x: DataFrame, flights_sml</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    speed<span class="op">=</span>flights_sml[<span class="st">"distance"</span>] <span class="op">/</span> flights_sml[<span class="st">"air_time"</span>] <span class="op">*</span> <span class="dv">60</span>    <span class="co"># 직접 DataFrame 참조할 수도 있음</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>        year  month  day  distance  air_time  dep_delay  arr_delay   gain  \
0       2013      1    1      1400    227.00       2.00      11.00  -9.00   
1       2013      1    1      1416    227.00       4.00      20.00 -16.00   
2       2013      1    1      1089    160.00       2.00      33.00 -31.00   
...      ...    ...  ...       ...       ...        ...        ...    ...   
336773  2013      9   30       764       NaN        NaN        NaN    NaN   
336774  2013      9   30       419       NaN        NaN        NaN    NaN   
336775  2013      9   30       431       NaN        NaN        NaN    NaN   

        speed  
0      370.04  
1      374.27  
2      408.38  
...       ...  
336773    NaN  
336774    NaN  
336775    NaN  

[336776 rows x 9 columns]</code></pre>
</div>
</div>
<div id="cell-64" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 앞에서 만든 변수나 함수를 이용할 수 있음</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>flights_sml.assign(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    gain<span class="op">=</span><span class="kw">lambda</span> x: x.dep_delay <span class="op">-</span> x.arr_delay,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    hours<span class="op">=</span><span class="kw">lambda</span> x: x.air_time <span class="op">/</span> <span class="dv">60</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    gain_per_hour<span class="op">=</span><span class="kw">lambda</span> x: x.gain <span class="op">/</span> x.hours,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    rounded<span class="op">=</span><span class="kw">lambda</span> x: np.<span class="bu">round</span>(x.gain_per_hour, <span class="dv">1</span>)  <span class="co"># use a numpy function</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>        year  month  day  distance  air_time  dep_delay  arr_delay   gain  \
0       2013      1    1      1400    227.00       2.00      11.00  -9.00   
1       2013      1    1      1416    227.00       4.00      20.00 -16.00   
2       2013      1    1      1089    160.00       2.00      33.00 -31.00   
...      ...    ...  ...       ...       ...        ...        ...    ...   
336773  2013      9   30       764       NaN        NaN        NaN    NaN   
336774  2013      9   30       419       NaN        NaN        NaN    NaN   
336775  2013      9   30       431       NaN        NaN        NaN    NaN   

        hours  gain_per_hour  rounded  
0        3.78          -2.38    -2.40  
1        3.78          -4.23    -4.20  
2        2.67         -11.62   -11.60  
...       ...            ...      ...  
336773    NaN            NaN      NaN  
336774    NaN            NaN      NaN  
336775    NaN            NaN      NaN  

[336776 rows x 11 columns]</code></pre>
</div>
</div>
<div id="cell-65" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the fastest flights</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    flights_sml</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    .assign(speed<span class="op">=</span><span class="kw">lambda</span> x: x.distance <span class="op">/</span> x.air_time)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="st">"speed"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    .head(<span class="dv">5</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>        year  month  day  distance  air_time  dep_delay  arr_delay  speed
216447  2013      5   25       762     65.00       9.00     -14.00  11.72
251999  2013      7    2      1008     93.00      45.00      26.00  10.84
205388  2013      5   13       594     55.00      15.00      -1.00  10.80
157516  2013      3   23       748     70.00       4.00       2.00  10.69
10223   2013      1   12      1035    105.00      -1.00     -28.00   9.86</code></pre>
</div>
</div>
</section>
</section>
<section id="groups" class="level2">
<h2 class="anchored" data-anchor-id="groups">Groups</h2>
<section id="groupby" class="level3">
<h3 class="anchored" data-anchor-id="groupby"><code>groupby()</code></h3>
<ul>
<li><code>groupby()</code>는 데이터를 의미있는 그룹으로 나누어 분석할 수 있도록 해줌</li>
<li><code>.count()</code>, <code>.sum()</code>, <code>.mean()</code>, <code>.min()</code>, <code>.max()</code>과 같은 통계치를 구하는 methods와 함께 효과적으로, 자주 활용됨</li>
</ul>
<p><img src="images/group_agg.png" class="img-fluid" width="300"><br>
Source: <em>Ch.10 in Python for Data Analysis (3e)</em> by Wes McKinney</p>
<p>아래 표는 <code>groupby()</code>와 함께 자주 쓰이는 효율적인 methods<br>
<img src="images/groupby.png" class="img-fluid" width="600"><br>
Source: <em>Ch.10 in Python for Data Analysis (3e)</em> by Wes McKinney</p>
<div id="cell-70" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>flights.groupby(<span class="st">"month"</span>)  <span class="co"># “GroupBy” object</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x157d8de10&gt;</code></pre>
</div>
</div>
<div id="cell-71" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>flights_sml.groupby(<span class="st">"month"</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>         year   day  distance  air_time  dep_delay  arr_delay
month                                                        
1     2013.00 15.99   1006.84    154.19      10.04       6.13
2     2013.00 14.74   1000.98    151.35      10.82       5.61
3     2013.00 16.00   1011.99    149.08      13.23       5.81
...       ...   ...       ...       ...        ...        ...
10    2013.00 15.98   1038.88    148.89       6.24      -0.17
11    2013.00 15.29   1050.31    155.47       5.44       0.46
12    2013.00 15.72   1064.66    162.59      16.58      14.87

[12 rows x 6 columns]</code></pre>
</div>
</div>
<div id="cell-72" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 보통은 다음과 같이 특정 columns을 선택</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>flights.groupby(<span class="st">"month"</span>)[<span class="st">"dep_delay"</span>]  <span class="co"># [["dep_delay"]] 처럼 list로 입력하면 DataFrameGroupBy object</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>&lt;pandas.core.groupby.generic.SeriesGroupBy object at 0x157d88890&gt;</code></pre>
</div>
</div>
<div id="cell-73" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>flights.groupby(<span class="st">"month"</span>)[<span class="st">"dep_delay"</span>].mean()  <span class="co"># Series GroupBy object에 적용된 결과는 Series</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>month
1    10.04
2    10.82
3    13.23
      ... 
10    6.24
11    5.44
12   16.58
Name: dep_delay, Length: 12, dtype: float64</code></pre>
</div>
</div>
<div id="cell-74" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>flights.groupby(<span class="st">"month"</span>)[[<span class="st">"dep_delay"</span>, <span class="st">"arr_delay"</span>]].mean().head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>       dep_delay  arr_delay
month                      
1          10.04       6.13
2          10.82       5.61
3          13.23       5.81</code></pre>
</div>
</div>
<div id="cell-75" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>flights.groupby([<span class="st">"month"</span>, <span class="st">"day"</span>])[<span class="st">"arr_delay"</span>].nsmallest(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>month  day        
1      1    696      -48.00
       2    919      -59.00
       3    2035     -65.00
                      ...  
12     29   108914   -60.00
       30   110330   -45.00
       31   111113   -44.00
Name: arr_delay, Length: 365, dtype: float64</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Multi-index의 level을 drop하려면 <code>droplevel()</code></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>flights.groupby([<span class="st">"month"</span>, <span class="st">"day"</span>])[<span class="st">"arr_delay"</span>].nsmallest(<span class="dv">1</span>).droplevel(<span class="dv">2</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co"># month  day</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1      1     -48.00</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co">#        2     -59.00</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co">#        3     -65.00</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co">#               ...  </span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 12     29    -60.00</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co">#        30    -45.00</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co">#        31    -44.00</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Name: arr_delay, Length: 365, dtype: float64</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="cell-77" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>flights.groupby([<span class="st">"origin"</span>, <span class="st">"dest"</span>])[<span class="st">"arr_delay"</span>].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>origin  dest
EWR     ALB      418
        ANC        8
        ATL     4876
                ... 
LGA     TVC       73
        TYS      265
        XNA      709
Name: arr_delay, Length: 224, dtype: int64</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>as_index=False</code>: grouping 변수들을 index가 아닌 columns으로</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>flights.groupby([<span class="st">"month"</span>, <span class="st">"day"</span>], as_index<span class="op">=</span><span class="va">False</span>)[<span class="st">"arr_delay"</span>].mean().head(<span class="dv">3</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co">#    month  day  arr_delay</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 0      1    1      12.65</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1      1    2      12.69</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2      1    3       5.73</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>물론, 결과물에 <code>.reset_index()</code> method를 사용해도 됨</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>원칙적으로 grouping은 같은 DataFrame의 변수일 필요없이 match만 되면 됨<br>
Source: Wes McKinney’s</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co">#    key1  key2  data1  data2</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 0     a     1   0.36  -0.42</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1     a     2  -1.51   0.04</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2  None     1   0.75  -0.28</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 3     b     2   0.57   0.25</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 4     b     1   1.30  -0.77</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 5     a  &lt;NA&gt;  -0.53  -0.73</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 6  None     1   2.04  -0.37</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>states <span class="op">=</span> np.array([<span class="st">"OH"</span>, <span class="st">"CA"</span>, <span class="st">"CA"</span>, <span class="st">"OH"</span>, <span class="st">"OH"</span>, <span class="st">"CA"</span>, <span class="st">"OH"</span>])</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> [<span class="dv">2005</span>, <span class="dv">2005</span>, <span class="dv">2006</span>, <span class="dv">2005</span>, <span class="dv">2006</span>, <span class="dv">2005</span>, <span class="dv">2006</span>]</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"data1"</span>].groupby([states, years]).mean()</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="co"># CA  2005   -1.02</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     2006    0.75</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="co"># OH  2005    0.46</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     2006    1.67</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Name: data1, dtype: float64</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="cell-81" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>flights.groupby(<span class="st">"dest"</span>).size()  <span class="co"># .size(): group의 사이즈/열의 갯수</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>dest
ABQ     254
ACK     265
ALB     439
       ... 
TVC     101
TYS     631
XNA    1036
Length: 105, dtype: int64</code></pre>
</div>
</div>
<div id="cell-82" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>flights.groupby(<span class="st">"tailnum"</span>, dropna<span class="op">=</span><span class="va">False</span>).size()  <span class="co"># groupby는 기본적으로 NA 무시</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>tailnum
D942DN       4
N0EGMQ     371
N10156     153
          ... 
N999DN      61
N9EAMQ     248
NaN       2512
Length: 4044, dtype: int64</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>.size()</code>는 <code>.value_counts()</code>와 유사하게 사용될 수 있음</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>flights[<span class="st">"tailnum"</span>].value_counts(dropna<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># NaN       2512</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># N725MQ     575</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># N722MQ     513</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co">#           ... </span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co"># N318AS       1</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># N651UA       1</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="co"># N557AS       1</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Name: tailnum, Length: 4044, dtype: int64</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Index에 grouping하는 방식에 대해서는 Wes McKineey’s Chapter 10 참고</p>
<ul>
<li>Grouping with Dictionaries and Series</li>
<li>Grouping with Functions</li>
<li>Grouping by Index Levels</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Time series 데이터의 경우 다양한 grouping 방식이 존재<br>
Stephanie Molin의 <em>ch.4 Working with time series data</em> 참고</p>
<p>예를 들어, facebook stock에 대한 자료에서 2018년 4분기에 해당하는 날을 week단위로 그룹핑하여 volume을 다음과 같이 계산할 수 있음</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>fb.loc[<span class="st">'2018-Q4'</span>].groupby(pd.Grouper(freq<span class="op">=</span><span class="st">'W'</span>)).volume.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>groupby filtering</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>flights.groupby([<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>]).<span class="bu">filter</span>(<span class="kw">lambda</span> x: x[<span class="st">"arr_delay"</span>].mean() <span class="op">&lt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>좀 더 복잡한 groupby filtering은 이후 apply를 이용</p>
</div>
</div>
<hr>
</section>
<section id="agg" class="level3">
<h3 class="anchored" data-anchor-id="agg"><code>agg()</code></h3>
<p>Aggregations: data transformation that produces <strong>scalar</strong> values from arrays</p>
<p>앞서 GroupBy object에 직접 stats function을 적용하였는데, <code>agg()</code>를 이용하여 더 확장, 일반화할 수 있음</p>
<div id="cell-89" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 모두 동일</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>flights_sml.groupby(<span class="st">"month"</span>).mean()</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>flights_sml.groupby(<span class="st">"month"</span>).agg(<span class="st">"mean"</span>)  <span class="co"># function names</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>flights_sml.groupby(<span class="st">"month"</span>).agg(np.mean)  <span class="co"># numpy functions</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>flights_sml.groupby(<span class="st">"month"</span>).agg(<span class="kw">lambda</span> x: x.<span class="bu">sum</span>() <span class="op">/</span> x.count())  <span class="co"># general functions; not optimized!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-90" class="cell" data-execution_count="20">
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>         year   day  distance  air_time  dep_delay  arr_delay
month                                                        
1     2013.00 15.99   1006.84    154.19      10.04       6.13
2     2013.00 14.74   1000.98    151.35      10.82       5.61
3     2013.00 16.00   1011.99    149.08      13.23       5.81
...       ...   ...       ...       ...        ...        ...
10    2013.00 15.98   1038.88    148.89       6.24      -0.17
11    2013.00 15.29   1050.31    155.47       5.44       0.46
12    2013.00 15.72   1064.66    162.59      16.58      14.87

[12 rows x 6 columns]</code></pre>
</div>
</div>
<div id="cell-91" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>flights_sml.groupby(<span class="st">"month"</span>)[<span class="st">"arr_delay"</span>].agg(<span class="st">"mean"</span>)  <span class="co"># Series에 string으로 함수 적용</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>month
1     6.13
2     5.61
3     5.81
      ... 
10   -0.17
11    0.46
12   14.87
Name: arr_delay, Length: 12, dtype: float64</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>차이 참고</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>flights_sml.groupby(<span class="st">"month"</span>)[<span class="st">"arr_delay"</span>].agg([<span class="st">"mean"</span>])  <span class="co"># list로 함수를 입력하는 경우</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>flights_sml.groupby(<span class="st">"month"</span>)[[<span class="st">"arr_delay"</span>]].agg(<span class="st">"mean"</span>)  <span class="co"># DataFrame에 적용될 때</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#        mean                    arr_delay</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co"># month                 # month</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1      6.13           # 1           6.13</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2      5.61           # 2           5.61</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 3      5.81           # 3           5.81</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ...                   # ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="cell-93" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>flights.groupby(<span class="st">"month"</span>)[<span class="st">"dep_delay"</span>].agg([<span class="st">"mean"</span>, <span class="st">"count"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>       mean  count
month             
1     10.04  26483
2     10.82  23690
3     13.23  27973
...     ...    ...
10     6.24  28653
11     5.44  27035
12    16.58  27110

[12 rows x 2 columns]</code></pre>
</div>
</div>
<div id="cell-94" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>flights_sml.groupby(<span class="st">"month"</span>)[[<span class="st">"arr_delay"</span>]].agg([<span class="st">"mean"</span>, <span class="st">"median"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>      arr_delay       
           mean median
month                 
1          6.13  -3.00
2          5.61  -3.00
3          5.81  -6.00
...         ...    ...
10        -0.17  -7.00
11         0.46  -6.00
12        14.87   2.00

[12 rows x 2 columns]</code></pre>
</div>
</div>
<div id="cell-95" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DataFrame Groupby object의 경우 column 별로 적용</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>flights_sml.groupby(<span class="st">"month"</span>)[[<span class="st">"arr_delay"</span>, <span class="st">"dep_delay"</span>]].agg(<span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>       arr_delay  dep_delay
month                      
1           6.13      10.04
2           5.61      10.82
3           5.81      13.23
...          ...        ...
10         -0.17       6.24
11          0.46       5.44
12         14.87      16.58

[12 rows x 2 columns]</code></pre>
</div>
</div>
<div id="cell-96" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>flights_sml.groupby(<span class="st">"month"</span>)[[<span class="st">"arr_delay"</span>, <span class="st">"dep_delay"</span>]].agg([<span class="st">"mean"</span>, <span class="st">"count"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>      arr_delay        dep_delay       
           mean  count      mean  count
month                                  
1          6.13  26398     10.04  26483
2          5.61  23611     10.82  23690
3          5.81  27902     13.23  27973
...         ...    ...       ...    ...
10        -0.17  28618      6.24  28653
11         0.46  26971      5.44  27035
12        14.87  27020     16.58  27110

[12 rows x 4 columns]</code></pre>
</div>
</div>
<p>컬럼 별로 다른 함수를 적용하고자 할 때 (컬럼 이름을 지정): <code>tuple</code></p>
<div id="cell-98" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>flights_agg <span class="op">=</span> (</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    flights.groupby(<span class="st">"month"</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    .agg(</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>        air_min<span class="op">=</span>(<span class="st">"air_time"</span>, <span class="st">"min"</span>),  <span class="co"># 컬럼 이름 지정 = (컬럼, 함수)</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>        air_max<span class="op">=</span>(<span class="st">"air_time"</span>, <span class="st">"max"</span>),</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>        dep_mean<span class="op">=</span>(<span class="st">"dep_delay"</span>, <span class="st">"mean"</span>),</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>        arr_median<span class="op">=</span>(<span class="st">"arr_delay"</span>, <span class="st">"median"</span>),</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>flights_agg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>       air_min  air_max  dep_mean  arr_median
month                                        
1        20.00   667.00     10.04       -3.00
2        21.00   691.00     10.82       -3.00
3        21.00   695.00     13.23       -6.00
...        ...      ...       ...         ...
10       23.00   642.00      6.24       -7.00
11       24.00   676.00      5.44       -6.00
12       21.00   661.00     16.58        2.00

[12 rows x 4 columns]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>컬럼별 다른 함수를 적용하는 다른 방식: <code>dictionary</code></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>flights_agg <span class="op">=</span> flights.groupby(<span class="st">"month"</span>).agg({</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"air_time"</span>: [<span class="st">"min"</span>, <span class="st">"max"</span>],</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dep_delay"</span>: <span class="st">"mean"</span>,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"arr_delay"</span>: <span class="st">"median"</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="co">#       air_time        dep_delay arr_delay</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="co">#            min    max      mean    median</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="co"># month                                    </span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 1        20.00 667.00     10.04     -3.00</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2        21.00 691.00     10.82     -3.00</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 3        21.00 695.00     13.23     -6.00</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>MultiIndex를 collapse하는 팁</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>flights_agg.columns</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co"># MultiIndex([( 'air_time',    'min'),</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co">#             ( 'air_time',    'max'),</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co">#             ('dep_delay',   'mean'),</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co">#             ('arr_delay', 'median')],</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co">#            )</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>flights_agg.columns <span class="op">=</span> [<span class="st">'_'</span>.join(col_agg) <span class="cf">for</span> col_agg <span class="kw">in</span> flights_agg.columns]</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>flights_agg.head(<span class="dv">3</span>)</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="co">#        air_time_min  air_time_max  dep_delay_mean  arr_delay_median</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="co"># month                                                              </span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 1             20.00        667.00           10.04             -3.00</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 2             21.00        691.00           10.82             -3.00</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 3             21.00        695.00           13.23             -6.00</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>agg()</code>에는 custom function을 pass할 수 있음<br>
단, the optimized functions (Table 10-1)에 비해 일반적으로 훨씬 느림</p>
</div>
</div>
<div id="cell-101" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> peak_to_peak(arr):</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> arr.<span class="bu">max</span>() <span class="op">-</span> arr.<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-102" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>grouped_dist <span class="op">=</span> flights_sml.groupby([<span class="st">"month"</span>, <span class="st">"day"</span>])[<span class="st">"distance"</span>]</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>grouped_dist.agg([<span class="st">"std"</span>, peak_to_peak])  <span class="co"># a list of functions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>             std  peak_to_peak
month day                     
1     1   727.73          4889
      2   721.72          4889
      3   714.95          4903
...          ...           ...
12    29  728.78          4887
      30  723.88          4887
      31  731.36          4887

[365 rows x 2 columns]</code></pre>
</div>
</div>
<div id="cell-103" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Naming a function as a tuple</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>grouped_dist.agg([(<span class="st">"sd"</span>, <span class="st">"std"</span>), (<span class="st">"range"</span>, peak_to_peak)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>              sd  range
month day              
1     1   727.73   4889
      2   721.72   4889
      3   714.95   4903
...          ...    ...
12    29  728.78   4887
      30  723.88   4887
      31  731.36   4887

[365 rows x 2 columns]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>.describe()</code>는 aggregation은 아니나 grouped objects에 적용가능</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>flights_sml.groupby(<span class="st">"month"</span>)[[<span class="st">"dep_delay"</span>, <span class="st">"arr_delay"</span>]].describe()</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co">#       dep_delay                                              arr_delay        \</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co">#           count  mean   std    min   25%   50%   75%     max     count  mean   </span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co"># month                                                                          </span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1      26483.00 10.04 36.39 -30.00 -5.00 -2.00  8.00 1301.00  26398.00  6.13   </span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2      23690.00 10.82 36.27 -33.00 -5.00 -2.00  9.00  853.00  23611.00  5.61   </span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 3      27973.00 13.23 40.13 -25.00 -5.00 -1.00 12.00  911.00  27902.00  5.81   </span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ...         ...   ...   ...    ...   ...   ...   ...     ...       ...   ...    </span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>                                               </span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co">#         std    min    25%   50%   75%     max  </span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="co"># month                                          </span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 1     40.42 -70.00 -15.00 -3.00 13.00 1272.00  </span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 2     39.53 -70.00 -15.00 -3.00 13.00  834.00  </span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 3     44.12 -68.00 -18.00 -6.00 13.00  915.00  </span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ...     ...    ...    ...   ...   ...     ...  </span></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a><span class="co"># [12 rows x 16 columns]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="transform" class="level3">
<h3 class="anchored" data-anchor-id="transform"><code>transform()</code></h3>
<p>앞서 group별로 통계치가 summary되어 원래 reduced 데이터프레임으로 변형됐다면,<br>
<code>transform()</code>은 group별로 얻은 통계치가 원래 데이터의 형태를 그대로 보존하면서 출력<br>
만약, 전달되는 함수가 Series를 반환하려면, 동일한 사이즈로 반환되어야 함.</p>
<p><img src="images/group_transform.png" class="img-fluid" width="420"></p>
<div id="cell-106" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>flights_sml.groupby([<span class="st">"month"</span>])[<span class="st">"arr_delay"</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>month
1     6.13
2     5.61
3     5.81
      ... 
10   -0.17
11    0.46
12   14.87
Name: arr_delay, Length: 12, dtype: float64</code></pre>
</div>
</div>
<div id="cell-107" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>grouped_delay <span class="op">=</span> flights_sml.groupby([<span class="st">"month"</span>])[<span class="st">"arr_delay"</span>].transform(<span class="st">"mean"</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>grouped_delay</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>0         6.13
1         6.13
2         6.13
          ... 
336773   -4.02
336774   -4.02
336775   -4.02
Name: arr_delay, Length: 336776, dtype: float64</code></pre>
</div>
</div>
<div id="cell-108" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>flights_sml[<span class="st">"monthly_delay"</span>] <span class="op">=</span> grouped_delay</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>flights_sml</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>        year  month  day  distance  air_time  dep_delay  arr_delay  \
0       2013      1    1      1400    227.00       2.00      11.00   
1       2013      1    1      1416    227.00       4.00      20.00   
2       2013      1    1      1089    160.00       2.00      33.00   
...      ...    ...  ...       ...       ...        ...        ...   
336773  2013      9   30       764       NaN        NaN        NaN   
336774  2013      9   30       419       NaN        NaN        NaN   
336775  2013      9   30       431       NaN        NaN        NaN   

        monthly_delay  
0                6.13  
1                6.13  
2                6.13  
...               ...  
336773          -4.02  
336774          -4.02  
336775          -4.02  

[336776 rows x 8 columns]</code></pre>
</div>
</div>
<p>Q: 1년에 10000편 이상 운항편이 있는 도착지로 가는 항공편들만 추리면,</p>
<div id="cell-110" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>dest_size <span class="op">=</span>  flights.groupby(<span class="st">"dest"</span>).transform(<span class="st">"size"</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>dest_size</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 또는 flights.groupby("dest")["dest"].transform("count")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>0          7198
1          7198
2         11728
          ...  
336773     6333
336774     4573
336775     8163
Length: 336776, dtype: int64</code></pre>
</div>
</div>
<div id="cell-111" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1년에 10000편 이상 운항편이 있는 도착지에 대한 항공편</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>flights[dest_size <span class="op">&gt;=</span> <span class="dv">10000</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>        year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
2       2013      1    1    542.00             540       2.00    923.00   
4       2013      1    1    554.00             600      -6.00    812.00   
5       2013      1    1    554.00             558      -4.00    740.00   
...      ...    ...  ...       ...             ...        ...       ...   
336762  2013      9   30   2233.00            2113      80.00    112.00   
336763  2013      9   30   2235.00            2001     154.00     59.00   
336768  2013      9   30   2307.00            2255      12.00   2359.00   

        sched_arr_time  arr_delay carrier  flight tailnum origin dest  \
2                  850      33.00      AA    1141  N619AA    JFK  MIA   
4                  837     -25.00      DL     461  N668DN    LGA  ATL   
5                  728      12.00      UA    1696  N39463    EWR  ORD   
...                ...        ...     ...     ...     ...    ...  ...   
336762              30      42.00      UA     471  N578UA    EWR  SFO   
336763            2249     130.00      B6    1083  N804JB    JFK  MCO   
336768            2358       1.00      B6     718  N565JB    JFK  BOS   

        air_time  distance  hour  minute  
2         160.00      1089     5      40  
4         116.00       762     6       0  
5         150.00       719     5      58  
...          ...       ...   ...     ...  
336762    318.00      2565    21      13  
336763    123.00       944    20       1  
336768     33.00       187    22      55  

[131440 rows x 18 columns]</code></pre>
</div>
</div>
<p>Q: 하루 중 출발 지연이 가장 늦은 두 항공편들을 매일 각각 구하면,</p>
<div id="cell-113" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_ranks(group):</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> group.rank(ascending<span class="op">=</span><span class="va">False</span>, method<span class="op">=</span><span class="st">"min"</span>) <span class="co"># method: 동일 등수에 대한 처리방식</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>delay_rank <span class="op">=</span> flights.groupby([<span class="st">"month"</span>, <span class="st">"day"</span>])[<span class="st">"dep_delay"</span>].transform(get_ranks)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 또는 .transform("rank", ascending=False, method="min")  # using "rank" 함수</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>delay_rank</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>0        302.00
1        269.00
2        302.00
          ...  
336773      NaN
336774      NaN
336775      NaN
Name: dep_delay, Length: 336776, dtype: float64</code></pre>
</div>
</div>
<div id="cell-114" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>flights[delay_rank <span class="op">&lt;</span> <span class="dv">3</span>].head(<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>      year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \
151   2013      1    1    848.00            1835     853.00   1001.00   
834   2013      1    1   2343.00            1724     379.00    314.00   
1440  2013      1    2   1607.00            1030     337.00   2003.00   
1749  2013      1    2   2131.00            1512     379.00   2340.00   
2598  2013      1    3   2008.00            1540     268.00   2339.00   
2637  2013      1    3   2056.00            1605     291.00   2239.00   

      sched_arr_time  arr_delay carrier  flight tailnum origin dest  air_time  \
151             1950     851.00      MQ    3944  N942MQ    JFK  BWI     41.00   
834             1938     456.00      EV    4321  N21197    EWR  MCI    222.00   
1440            1355     368.00      AA     179  N324AA    JFK  SFO    346.00   
1749            1741     359.00      UA     488  N593UA    LGA  DEN    228.00   
2598            1909     270.00      DL    2027  N338NW    JFK  FLL    158.00   
2637            1754     285.00      9E    3459  N928XJ    JFK  BNA    125.00   

      distance  hour  minute  
151        184    18      35  
834       1092    17      24  
1440      2586    10      30  
1749      1620    15      12  
2598      1069    15      40  
2637       765    16       5  </code></pre>
</div>
</div>
<p>Q: Standarize air time by destination</p>
<div id="cell-116" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>dest_air <span class="op">=</span> flights.groupby(<span class="st">"dest"</span>)[<span class="st">"air_time"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-117" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Z = (x - mean) / std</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>(flights[<span class="st">'air_time'</span>] <span class="op">-</span> dest_air.transform(<span class="st">'mean'</span>)) <span class="op">/</span> dest_air.transform(<span class="st">'std'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>0        1.73
1        1.73
2        0.61
         ... 
336773    NaN
336774    NaN
336775    NaN
Name: air_time, Length: 336776, dtype: float64</code></pre>
</div>
</div>
<div id="cell-118" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> standardize(x):</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x <span class="op">-</span> x.mean()) <span class="op">/</span> x.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-119" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>dest_air.transform(standardize)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>0        1.73
1        1.73
2        0.61
         ... 
336773    NaN
336774    NaN
336775    NaN
Name: air_time, Length: 336776, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="apply" class="level3">
<h3 class="anchored" data-anchor-id="apply"><code>apply()</code></h3>
<p><a href="https://wesmckinney.com/book/data-aggregation.html#groupby_apply">Apply: General split-apply-combine</a> in McKineey’s Chapter 10.3 참고</p>
<blockquote class="blockquote">
<p>The most general-purpose GroupBy method is apply, which is the subject of this section. apply splits the object being manipulated into pieces, invokes the passed function on each piece, and then attempts to concatenate the pieces.</p>
</blockquote>
<div id="cell-122" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>tips <span class="op">=</span> sns.load_dataset(<span class="st">"tips"</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>tips <span class="op">=</span> tips.assign(tip_pct <span class="op">=</span> <span class="kw">lambda</span> x: x.tip <span class="op">/</span> x.total_bill)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>tips.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>   total_bill  tip     sex smoker  day    time  size  tip_pct
0       16.99 1.01  Female     No  Sun  Dinner     2     0.06
1       10.34 1.66    Male     No  Sun  Dinner     3     0.16
2       21.01 3.50    Male     No  Sun  Dinner     3     0.17</code></pre>
</div>
</div>
<div id="cell-123" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> top(df, n<span class="op">=</span><span class="dv">5</span>, column<span class="op">=</span><span class="st">"tip_pct"</span>):</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df.sort_values(column, ascending<span class="op">=</span><span class="va">False</span>)[:n]  <span class="co"># DataFrame을 반환</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-124" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>top(tips, n<span class="op">=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>     total_bill  tip     sex smoker  day    time  size  tip_pct
172        7.25 5.15    Male    Yes  Sun  Dinner     2     0.71
178        9.60 4.00  Female    Yes  Sun  Dinner     2     0.42
67         3.07 1.00  Female    Yes  Sat  Dinner     1     0.33
232       11.61 3.39    Male     No  Sat  Dinner     2     0.29</code></pre>
</div>
</div>
<div id="cell-125" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DataFrame Groupby ojbect에 적용</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>tips.groupby(<span class="st">"time"</span>, observed<span class="op">=</span><span class="va">False</span>).<span class="bu">apply</span>(top)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>            total_bill  tip     sex smoker   day    time  size  tip_pct
time                                                                   
Lunch  149        7.51 2.00    Male     No  Thur   Lunch     2     0.27
       221       13.42 3.48  Female    Yes   Fri   Lunch     2     0.26
       194       16.58 4.00    Male    Yes  Thur   Lunch     2     0.24
...                ...  ...     ...    ...   ...     ...   ...      ...
Dinner 67         3.07 1.00  Female    Yes   Sat  Dinner     1     0.33
       232       11.61 3.39    Male     No   Sat  Dinner     2     0.29
       183       23.17 6.50    Male    Yes   Sun  Dinner     4     0.28

[10 rows x 8 columns]</code></pre>
</div>
</div>
<div id="cell-126" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>tips.groupby([<span class="st">"time"</span>, <span class="st">"day"</span>], observed<span class="op">=</span><span class="va">False</span>).<span class="bu">apply</span>(top, n<span class="op">=</span><span class="dv">1</span>, column<span class="op">=</span><span class="st">"total_bill"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>                 total_bill   tip     sex smoker   day    time  size  tip_pct
time   day                                                                   
Lunch  Thur 197       43.11  5.00  Female    Yes  Thur   Lunch     4     0.12
       Fri  225       16.27  2.50  Female    Yes   Fri   Lunch     2     0.15
Dinner Thur 243       18.78  3.00  Female     No  Thur  Dinner     2     0.16
       Fri  95        40.17  4.73    Male    Yes   Fri  Dinner     4     0.12
       Sat  170       50.81 10.00    Male    Yes   Sat  Dinner     3     0.20
       Sun  156       48.17  5.00    Male     No   Sun  Dinner     6     0.10</code></pre>
</div>
</div>
<p>GroupBy안에서 describe()와 같은 method를 적용하면, 사실 다음과 같은 shortcut임</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(group):</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> group.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-128" class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>tips.groupby(<span class="st">"sex"</span>, observed<span class="op">=</span><span class="va">False</span>)[<span class="st">"tip_pct"</span>].describe().T  <span class="co"># T: transpose</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>sex     Male  Female
count 157.00   87.00
mean    0.16    0.17
std     0.06    0.05
...      ...     ...
50%     0.15    0.16
75%     0.19    0.19
max     0.71    0.42

[8 rows x 2 columns]</code></pre>
</div>
</div>
<div id="cell-129" class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mean2(group):</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> group.mean()  <span class="co"># Series를 반환!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-130" class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>tips.groupby(<span class="st">"time"</span>, observed<span class="op">=</span><span class="va">False</span>)[[<span class="st">"total_bill"</span>, <span class="st">"tip"</span>]].<span class="bu">apply</span>(mean2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>        total_bill  tip
time                   
Lunch        17.17 2.73
Dinner       20.80 3.10</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>적용되는 함수는 pandas object나 <strong>scalar value</strong>를 반환해야 함</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>위에서 <code>agg()</code>에 custom function을 pass할 수 있지만, 일반적으로 훨씬 느리다고 했는데,<br>
이는 numeric array에 <code>apply()</code> method를 사용할 때에도 해당됨.<br>
가능하다면, <code>apply()</code>를 피하는 것이 실행 속도를 크게 높일 수 있음. (단, “string”에 적용될 때는 차이 없음)</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Suppressing the Group Keys">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Suppressing the Group Keys
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>tips.groupby(<span class="st">"time"</span>, group_keys<span class="op">=</span><span class="va">False</span>).<span class="bu">apply</span>(top)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="co">#      total_bill  tip     sex smoker   day    time  size  tip_pct</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 149        7.51 2.00    Male     No  Thur   Lunch     2     0.27</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 221       13.42 3.48  Female    Yes   Fri   Lunch     2     0.26</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 194       16.58 4.00    Male    Yes  Thur   Lunch     2     0.24</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Hide warnings">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hide warnings
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">"ignore"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>pandas method 비교</p>
<ul>
<li><code>applymap</code>: element-wise, DataFrame method</li>
<li><code>map</code>: element-wise, Series method</li>
<li><code>apply</code>: column/row-wise, DataFrame method, 또는 element-wise, Series method</li>
</ul>
<p><img src="images/apply.png" class="img-fluid" width="700"></p>
<p><a href="https://stackoverflow.com/questions/19798153/difference-between-map-applymap-and-apply-methods-in-pandas">Source, 비교 참고</a></p>
<div id="cell-136" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> my_format(x):</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>x<span class="sc">:.1f}</span><span class="ss">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-137" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>tips_num <span class="op">=</span> tips.select_dtypes(<span class="st">"number"</span>)  <span class="co"># select numeric columns</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="co"># element-wise, DataFrame method</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>tips_num.applymap(my_format)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<pre><code>    total_bill  tip size tip_pct
0         17.0  1.0  2.0     0.1
1         10.3  1.7  3.0     0.2
2         21.0  3.5  3.0     0.2
..         ...  ...  ...     ...
241       22.7  2.0  2.0     0.1
242       17.8  1.8  2.0     0.1
243       18.8  3.0  2.0     0.2

[244 rows x 4 columns]</code></pre>
</div>
</div>
<div id="cell-138" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># element-wise, Series method</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>tips[<span class="st">"tip"</span>].<span class="bu">map</span>(my_format)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>0      1.0
1      1.7
2      3.5
      ... 
241    2.0
242    1.8
243    3.0
Name: tip, Length: 244, dtype: object</code></pre>
</div>
</div>
<div id="cell-139" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> peak_to_peak(arr):</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> arr.<span class="bu">max</span>() <span class="op">-</span> arr.<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-140" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># column-wise operation</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>tips_num.<span class="bu">apply</span>(peak_to_peak)</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="co"># row-wise operation</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>tips_num.<span class="bu">apply</span>(peak_to_peak, axis<span class="op">=</span><span class="st">"columns"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div>

</div>
<div id="cell-141" class="cell quarto-layout-panel" data-layout-ncol="2" data-execution_count="98">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>total_bill   47.74
tip           9.00
size          5.00
tip_pct       0.67
dtype: float64</code></pre>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>0     16.93
1     10.18
2     20.84
       ... 
241   22.58
242   17.72
243   18.62
Length: 244, dtype: float64</code></pre>
</div>
</div>
</div>
<p><strong>Groupby object에 적용</strong>할 때 비교</p>
<p><code>apply</code>에 패스되는 함수가 Series나 DataFrame를 반환하는 경우</p>
<div id="cell-143" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f2(x):</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.Series([x.<span class="bu">min</span>(), x.<span class="bu">max</span>()], index<span class="op">=</span>[<span class="st">"min"</span>, <span class="st">"max"</span>])  <span class="co"># Series를 반환</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-144" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply에 패스되는 함수가 Series를 반환하는 경우</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>tips_num.<span class="bu">apply</span>(f2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>     total_bill   tip  size  tip_pct
min        3.07  1.00     1     0.04
max       50.81 10.00     6     0.71</code></pre>
</div>
</div>
<div id="cell-145" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Series Groupby object의 경우</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>tips.groupby(<span class="st">"time"</span>, observed<span class="op">=</span><span class="va">False</span>)[<span class="st">"tip"</span>].<span class="bu">apply</span>(f2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>time       
Lunch   min    1.25
        max    6.70
Dinner  min    1.00
        max   10.00
Name: tip, dtype: float64</code></pre>
</div>
</div>
<div id="cell-146" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DataFrame GroupBy object의 경우</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f3(g):</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> g[<span class="st">"tip"</span>]</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.Series([x.<span class="bu">min</span>(), x.<span class="bu">max</span>()], index<span class="op">=</span>[<span class="st">"min"</span>, <span class="st">"max"</span>])</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>tips.groupby(<span class="st">"time"</span>, observed<span class="op">=</span><span class="va">False</span>).<span class="bu">apply</span>(f3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>        min   max
time             
Lunch  1.25  6.70
Dinner 1.00 10.00</code></pre>
</div>
</div>
<p><strong>Groupby filtering</strong></p>
<p>앞서 다음과 같이 <code>.filter()</code>를 이용하여 groupby filtering을 했는데, <code>apply</code>를 이용하여 좀 더 복잡한 filtering을 할 수 있음</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>flights.groupby([<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>]).<span class="bu">filter</span>(<span class="kw">lambda</span> x: x[<span class="st">"arr_delay"</span>].mean() <span class="op">&lt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>다음과 같은 방식으로 <code>apply</code>를 이용하여 filtering하면 위와 동일함.</p>
<div id="cell-150" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> less_than(group, t):</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>    condition <span class="op">=</span> group[<span class="st">"arr_delay"</span>].mean() <span class="op">&lt;</span> t</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> group <span class="cf">if</span> condition <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>flights.groupby([<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>]).<span class="bu">apply</span>(less_than, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>가령, 도착지연이 그날 하루 평균보다 낮았던 항공편들만 추리기</p>
<div id="cell-152" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> less_than_mean(group):</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> group[<span class="st">"arr_delay"</span>] <span class="op">&lt;</span> group[<span class="st">"arr_delay"</span>].mean()</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> group[idx]</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>flights.groupby([<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>]).<span class="bu">apply</span>(less_than_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="7" data-quarto-table-cell-role="th" data-valign="top">2013</td>
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">1</td>
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">1</td>
<td data-quarto-table-cell-role="th">0</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>517.00</td>
<td>515</td>
<td>2.00</td>
<td>830.00</td>
<td>819</td>
<td>11.00</td>
<td>UA</td>
<td>1545</td>
<td>N14228</td>
<td>EWR</td>
<td>IAH</td>
<td>227.00</td>
<td>1400</td>
<td>5</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>544.00</td>
<td>545</td>
<td>-1.00</td>
<td>1004.00</td>
<td>1022</td>
<td>-18.00</td>
<td>B6</td>
<td>725</td>
<td>N804JB</td>
<td>JFK</td>
<td>BQN</td>
<td>183.00</td>
<td>1576</td>
<td>5</td>
<td>45</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>554.00</td>
<td>600</td>
<td>-6.00</td>
<td>812.00</td>
<td>837</td>
<td>-25.00</td>
<td>DL</td>
<td>461</td>
<td>N668DN</td>
<td>LGA</td>
<td>ATL</td>
<td>116.00</td>
<td>762</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">12</td>
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">31</td>
<td data-quarto-table-cell-role="th">111276</td>
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2328.00</td>
<td>2330</td>
<td>-2.00</td>
<td>412.00</td>
<td>409</td>
<td>3.00</td>
<td>B6</td>
<td>1389</td>
<td>N651JB</td>
<td>EWR</td>
<td>SJU</td>
<td>198.00</td>
<td>1608</td>
<td>23</td>
<td>30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">111278</td>
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2355.00</td>
<td>2359</td>
<td>-4.00</td>
<td>430.00</td>
<td>440</td>
<td>-10.00</td>
<td>B6</td>
<td>1503</td>
<td>N509JB</td>
<td>JFK</td>
<td>SJU</td>
<td>195.00</td>
<td>1598</td>
<td>23</td>
<td>59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">111279</td>
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2356.00</td>
<td>2359</td>
<td>-3.00</td>
<td>436.00</td>
<td>445</td>
<td>-9.00</td>
<td>B6</td>
<td>745</td>
<td>N665JB</td>
<td>JFK</td>
<td>PSE</td>
<td>200.00</td>
<td>1617</td>
<td>23</td>
<td>59</td>
</tr>
</tbody>
</table>

<p>207909 rows × 18 columns</p>
</div>
</div>
</div>
<p>grouping 변수를 제거하고 깔끔하게 하려면; <code>group_keys=False</code></p>
<div id="cell-154" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>flights.groupby([<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>], group_keys<span class="op">=</span><span class="va">False</span>).<span class="bu">apply</span>(less_than_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">day</th>
<th data-quarto-table-cell-role="th">dep_time</th>
<th data-quarto-table-cell-role="th">sched_dep_time</th>
<th data-quarto-table-cell-role="th">dep_delay</th>
<th data-quarto-table-cell-role="th">arr_time</th>
<th data-quarto-table-cell-role="th">sched_arr_time</th>
<th data-quarto-table-cell-role="th">arr_delay</th>
<th data-quarto-table-cell-role="th">carrier</th>
<th data-quarto-table-cell-role="th">flight</th>
<th data-quarto-table-cell-role="th">tailnum</th>
<th data-quarto-table-cell-role="th">origin</th>
<th data-quarto-table-cell-role="th">dest</th>
<th data-quarto-table-cell-role="th">air_time</th>
<th data-quarto-table-cell-role="th">distance</th>
<th data-quarto-table-cell-role="th">hour</th>
<th data-quarto-table-cell-role="th">minute</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>517.00</td>
<td>515</td>
<td>2.00</td>
<td>830.00</td>
<td>819</td>
<td>11.00</td>
<td>UA</td>
<td>1545</td>
<td>N14228</td>
<td>EWR</td>
<td>IAH</td>
<td>227.00</td>
<td>1400</td>
<td>5</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>544.00</td>
<td>545</td>
<td>-1.00</td>
<td>1004.00</td>
<td>1022</td>
<td>-18.00</td>
<td>B6</td>
<td>725</td>
<td>N804JB</td>
<td>JFK</td>
<td>BQN</td>
<td>183.00</td>
<td>1576</td>
<td>5</td>
<td>45</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2013</td>
<td>1</td>
<td>1</td>
<td>554.00</td>
<td>600</td>
<td>-6.00</td>
<td>812.00</td>
<td>837</td>
<td>-25.00</td>
<td>DL</td>
<td>461</td>
<td>N668DN</td>
<td>LGA</td>
<td>ATL</td>
<td>116.00</td>
<td>762</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">111276</td>
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2328.00</td>
<td>2330</td>
<td>-2.00</td>
<td>412.00</td>
<td>409</td>
<td>3.00</td>
<td>B6</td>
<td>1389</td>
<td>N651JB</td>
<td>EWR</td>
<td>SJU</td>
<td>198.00</td>
<td>1608</td>
<td>23</td>
<td>30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">111278</td>
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2355.00</td>
<td>2359</td>
<td>-4.00</td>
<td>430.00</td>
<td>440</td>
<td>-10.00</td>
<td>B6</td>
<td>1503</td>
<td>N509JB</td>
<td>JFK</td>
<td>SJU</td>
<td>195.00</td>
<td>1598</td>
<td>23</td>
<td>59</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">111279</td>
<td>2013</td>
<td>12</td>
<td>31</td>
<td>2356.00</td>
<td>2359</td>
<td>-3.00</td>
<td>436.00</td>
<td>445</td>
<td>-9.00</td>
<td>B6</td>
<td>745</td>
<td>N665JB</td>
<td>JFK</td>
<td>PSE</td>
<td>200.00</td>
<td>1617</td>
<td>23</td>
<td>59</td>
</tr>
</tbody>
</table>

<p>207909 rows × 18 columns</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Custom methods">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Custom methods
</div>
</div>
<div class="callout-body-container callout-body">
<p>다음과 같이 pandas object에 custom method를 추가할 수 있음</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> select_cols(<span class="va">self</span>, <span class="op">*</span>cols):</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Select a subset of columns from the DataFrame.</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a><span class="co">    - cols (tuple of str): Column names to select. Use a colon (:) to specify a range of columns.</span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a><span class="co">    - pd.DataFrame: The DataFrame with selected columns.</span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a><span class="co">    - tips.select("tip", "day:size")</span></span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>    selected_cols <span class="op">=</span> []</span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> cols:</span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">":"</span> <span class="kw">in</span> col:</span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>            start, end <span class="op">=</span> col.split(<span class="st">":"</span>)</span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a>            columns <span class="op">=</span> <span class="va">self</span>.loc[:, start:end].columns</span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a>            selected_cols.extend(columns)</span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>            selected_cols.append(col)</span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">self</span>[selected_cols]</span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-27"><a href="#cb161-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the custom method to the DataFrame class</span></span>
<span id="cb161-28"><a href="#cb161-28" aria-hidden="true" tabindex="-1"></a>pd.DataFrame.select <span class="op">=</span> select_cols</span>
<span id="cb161-29"><a href="#cb161-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-30"><a href="#cb161-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-31"><a href="#cb161-31" aria-hidden="true" tabindex="-1"></a>flights.select(<span class="st">"origin"</span>, <span class="st">"dest"</span>, <span class="st">"dep_delay:arr_delay"</span>).head()</span>
<span id="cb161-32"><a href="#cb161-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   origin dest  dep_delay  arr_time  sched_arr_time  arr_delay</span></span>
<span id="cb161-33"><a href="#cb161-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 0    EWR  IAH       2.00    830.00             819      11.00</span></span>
<span id="cb161-34"><a href="#cb161-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 1    LGA  IAH       4.00    850.00             830      20.00</span></span>
<span id="cb161-35"><a href="#cb161-35" aria-hidden="true" tabindex="-1"></a><span class="co"># 2    JFK  MIA       2.00    923.00             850      33.00</span></span>
<span id="cb161-36"><a href="#cb161-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 3    JFK  BQN      -1.00   1004.00            1022     -18.00</span></span>
<span id="cb161-37"><a href="#cb161-37" aria-hidden="true" tabindex="-1"></a><span class="co"># 4    LGA  ATL      -6.00    812.00             837     -25.00</span></span>
<span id="cb161-38"><a href="#cb161-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-39"><a href="#cb161-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Build useful methods</span></span>
<span id="cb161-40"><a href="#cb161-40" aria-hidden="true" tabindex="-1"></a>flights.deselect()</span>
<span id="cb161-41"><a href="#cb161-41" aria-hidden="true" tabindex="-1"></a>flights.relocate()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/dgdavs\.modellings\.art");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../contents/Transform/subsetting.html" class="pagination-link" aria-label="Subsetting">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Subsetting</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../contents/Transform/case1.html" class="pagination-link" aria-label="Case 1">
        <span class="nav-page-text">Case 1</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>This work © 2024 by Sungkyun Cho is licensed under CC BY-NC-SA 4.0</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>